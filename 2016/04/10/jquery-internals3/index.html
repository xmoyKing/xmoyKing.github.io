<!DOCTYPE html>
<html style="display: none;" lang="en">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.0 -->
    <script>
        window.materialVersion = "1.5.0"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">

    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source"/>














    <!-- Title -->
    
    <title>
        
            jQuery技术内幕笔记-3-jQuery.fn.init 源码解读 | 
        
        KING · NOTE
    </title>

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no"/>
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="KING">
    <meta name="description" itemprop="description" content="Loneliness is the carnival of one single soul.">
    <meta name="keywords" content=",jQuery,jQuery技术内幕,jQuery.fn.init">

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(window.oldVersion){var remove=window.oldVersion.reduce(function(p,c){return p||data.indexOf("/*"+c+"*/")!==-1},false);if(remove){lsloader.removeLS(key)}}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload,isJs){if(typeof cssonload==="boolean"){isJs=cssonload;cssonload=undefined}isJs=isJs||false;cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}code=code.split(versionString)[1];if(isJs){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload,isJs)}};lsloader.requestResource=function(name,path,cssonload,isJs){var that=this;if(isJs){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else{this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="KING · NOTE">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.en.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/css/material.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/css/style.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->
<!-- add By KING 2017.11.16 -->
<link rel="stylesheet" href="/css/highlightjs/vs.css">
<style>
  #scheme-Paradox .material-layout .highlight .meta{
    display: initial;
    padding: initial;
  }
</style>


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icon -->

    <style>
        @font-face {
            font-family: 'Material Icons';
            font-style: normal;
            font-weight: 400;
            src: local('Material Icons'),
            local('MaterialIcons-Regular'),
            url(https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/fonts/MaterialIcons-Regular.woff2) format('woff2'),
            url(https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/fonts/MaterialIcons-Regular.woff) format('woff'),
            url(https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/fonts/MaterialIcons-Regular.ttf) format('truetype');
        }
    </style>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/js/jquery.min.js", true)</script>
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://github.com/xmoyKING">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="jQuery技术内幕笔记-3-jQuery.fn.init 源码解读 | KING · NOTE">
    <meta property="og:image" content="https://github.com/xmoyKING/img/favicon.png" />
    <meta property="og:description" content="Loneliness is the carnival of one single soul.">
    <meta property="og:article:tag" content="jQuery"> <meta property="og:article:tag" content="jQuery技术内幕"> <meta property="og:article:tag" content="jQuery.fn.init"> 

    
        <meta property="article:published_time" content="Sun Apr 10 2016 10:25:32 GMT+0800" />
        <meta property="article:modified_time" content="Sun Apr 10 2016 10:25:32 GMT+0800" />
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="jQuery技术内幕笔记-3-jQuery.fn.init 源码解读 | KING · NOTE">
    <meta name="twitter:description" content="Loneliness is the carnival of one single soul.">
    <meta name="twitter:image" content="https://github.com/xmoyKING/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://github.com/xmoyKING" />

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://github.com/xmoyKING/2016/04/10/jquery-internals3/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "https://github.com/xmoyKING/2016/04/10/jquery-internals3/index.html",
    "headline": "jQuery技术内幕笔记-3-jQuery.fn.init 源码解读",
    "datePublished": "Sun Apr 10 2016 10:25:32 GMT+0800",
    "dateModified": "Sun Apr 10 2016 10:25:32 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "KING",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.png"
        },
        "description": "Loneliness is the carnival of one single soul."
    },
    "publisher": {
        "@type": "Organization",
        "name": "KING · NOTE",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",jQuery,jQuery技术内幕,jQuery.fn.init",
    "description": "Loneliness is the carnival of one single soul.",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#定义-jQuery-fn-init-selector-context-rootjQuery"><span class="post-toc-number">1.</span> <span class="post-toc-text">定义 jQuery.fn.init( selector, context, rootjQuery )</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#参数-selector-可以转换为-false"><span class="post-toc-number">2.</span> <span class="post-toc-text">参数 selector 可以转换为 false</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#参数-selector-是-DOM-元素"><span class="post-toc-number">3.</span> <span class="post-toc-text">参数 selector 是 DOM 元素</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#参数-selector-是字符串“body”"><span class="post-toc-number">4.</span> <span class="post-toc-text">参数 selector 是字符串“body”</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#参数-selector-是其他字符串"><span class="post-toc-number">5.</span> <span class="post-toc-text">参数 selector 是其他字符串</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#参数-selector-是单独标签"><span class="post-toc-number">5.1.</span> <span class="post-toc-text">参数 selector 是单独标签</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#参数-selector-是复杂-HTML-代码"><span class="post-toc-number">5.2.</span> <span class="post-toc-text">参数 selector 是复杂 HTML 代码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#参数-selector-是“-id”，且未指定参数-context"><span class="post-toc-number">5.3.</span> <span class="post-toc-text">参数 selector 是“#id”，且未指定参数 context</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#参数-selector-是选择器表达式"><span class="post-toc-number">5.4.</span> <span class="post-toc-text">参数 selector 是选择器表达式</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#参数-selector-是函数"><span class="post-toc-number">6.</span> <span class="post-toc-text">参数 selector 是函数</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#参数-selector-是-jQuery-对象"><span class="post-toc-number">7.</span> <span class="post-toc-text">参数 selector 是 jQuery 对象</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#参数-selector-是任意其他值"><span class="post-toc-number">8.</span> <span class="post-toc-text">参数 selector 是任意其他值</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#小结"><span class="post-toc-number">9.</span> <span class="post-toc-text">小结</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                jQuery技术内幕笔记-3-jQuery.fn.init 源码解读
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>KING</strong>
        <span>Apr 10, 2016</span>
        <!-- Updated Time , add By KING 2017.11.16 -->
        <span>Apr 10, 2016 UPDATED</span> 
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/jQuery/">jQuery</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/jQuery-fn-init/">jQuery.fn.init</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/jQuery技术内幕/">jQuery技术内幕</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=jQuery技术内幕笔记-3-jQuery.fn.init 源码解读&url=https://github.com/xmoyKING/2016/04/10/jquery-internals3/index.html&pic=https://github.com/xmoyKING/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                Share to Weibo
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=jQuery技术内幕笔记-3-jQuery.fn.init 源码解读&url=https://github.com/xmoyKING/2016/04/10/jquery-internals3/index.html&via=KING" target="_blank">
            <li class="mdl-menu__item">
                Share to Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://github.com/xmoyKING/2016/04/10/jquery-internals3/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://github.com/xmoyKING/2016/04/10/jquery-internals3/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>构造函数 jQuery.fn.init() 负责解析参数 selector 和 context 的类型，并执行相应的逻辑，最后返回 jQuery.fn.init() 的实例。参数 selector 和 context 共有 12 个有效分支。</p>
<p><img src="1.png" alt="参数 selector 和 context 的 12 个分支"><br>参数 selector 和 context 的 12 个分支</p>
<h3 id="定义-jQuery-fn-init-selector-context-rootjQuery"><a href="#定义-jQuery-fn-init-selector-context-rootjQuery" class="headerlink" title="定义 jQuery.fn.init( selector, context, rootjQuery )"></a>定义 jQuery.fn.init( selector, context, rootjQuery )</h3><p>相关代码如下所示：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">99</span> init: <span class="function"><span class="keyword">function</span>(<span class="params"> selector, context, rootjQuery </span>) </span>&#123;</span><br><span class="line"><span class="number">100</span> <span class="keyword">var</span> match, elem, ret, doc;</span><br></pre></td></tr></table></figure></p>
<p>第 99 行：定义构造函数 jQuery.fn.init( selector, context, rootjQuery )，它接受 3 个参数：</p>
<ul>
<li>参数 selector：可以是任意类型的值，但只有 undefined、DOM 元素、字符串、函数、jQuery 对象、普通 JavaScript 对象这几种类型是有效的，其他类型的值也可以接受但没有意义。</li>
<li>参数 context：可以不传入，或者传入 DOM 元素、jQuery 对象、普通 JavaScript 对象之一。</li>
<li>参数 rootjQuery：包含了 document 对象的 jQuery 对象，用于 document.getElementById() 查找失败、selector 是选择器表达式且未指定 context、selector 是函数的情况。rootjQuery 的定义和应用场景的代码如下所示：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// document.getElementById() 查找失败</span></span><br><span class="line"><span class="number">172</span> <span class="keyword">return</span> rootjQuery.find( selector );</span><br><span class="line"><span class="comment">// selector 是选择器表达式且未指定 context</span></span><br><span class="line"><span class="number">187</span> <span class="keyword">return</span> ( context || rootjQuery ).find( selector );</span><br><span class="line"><span class="comment">// selector 是函数</span></span><br><span class="line"><span class="number">198</span> <span class="keyword">return</span> rootjQuery.ready( selector );</span><br><span class="line"><span class="comment">// 定义 rootjQuery</span></span><br><span class="line"><span class="number">916</span> <span class="comment">// All jQuery objects should point back to these</span></span><br><span class="line"><span class="number">917</span> rootjQuery = jQuery(<span class="built_in">document</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="参数-selector-可以转换为-false"><a href="#参数-selector-可以转换为-false" class="headerlink" title="参数 selector 可以转换为 false"></a>参数 selector 可以转换为 false</h3><p>参数 selector 可以转换为 false，例如是 undefined、空字符串、null 等，则直接返回 this，此时 this 是空 jQuery 对象，其属性 length 等于 0。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">102</span> <span class="comment">// Handle $(""), $(null), or $( undefined )</span></span><br><span class="line"><span class="number">103</span> <span class="keyword">if</span> ( !selector ) &#123;</span><br><span class="line"><span class="number">104</span> <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line"><span class="number">105</span> &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="参数-selector-是-DOM-元素"><a href="#参数-selector-是-DOM-元素" class="headerlink" title="参数 selector 是 DOM 元素"></a>参数 selector 是 DOM 元素</h3><p>如果参数 selector 有属性 nodeType，则认为 selector 是 DOM 元素，手动设置第一个元素和属性 context 指向该 DOM 元素 、 属性 length 为 1，然后返回包含了该 DOM 元素引用的jQuery 对象。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">107</span> <span class="comment">// Handle $(DOMElement)</span></span><br><span class="line"><span class="number">108</span> <span class="keyword">if</span> ( selector.nodeType ) &#123;</span><br><span class="line"><span class="number">109</span> <span class="keyword">this</span>.context = <span class="keyword">this</span>[<span class="number">0</span>] = selector;</span><br><span class="line"><span class="number">110</span> <span class="keyword">this</span>.length = <span class="number">1</span>;</span><br><span class="line"><span class="number">111</span> <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line"><span class="number">112</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>第 108 行：属性 nodeType 声明了文档树中节点的类型，例如，Element 节点的该属性值是 1，Text 节点是 3，Comment 节点是 9，Document 对象是 9，DocumentFragment 节点是 11。</p>
<h3 id="参数-selector-是字符串“body”"><a href="#参数-selector-是字符串“body”" class="headerlink" title="参数 selector 是字符串“body”"></a>参数 selector 是字符串“body”</h3><p>如果参数 selector 是字符串“ body”，手动设置属性 context 指向 document 对象、第一个元素指向 body元素、属性 length 为 1，最后返回包含了 body 元素引用的 jQuery 对象。这里是对查找字符串“ body”的优化，因为文档树中只会存在一个 body 元素。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">114</span> <span class="comment">// The body element only exists once, optimize finding it</span></span><br><span class="line"><span class="number">115</span> <span class="keyword">if</span> ( selector === <span class="string">"body"</span> &amp;&amp; !context &amp;&amp; <span class="built_in">document</span>.body ) &#123;</span><br><span class="line"><span class="number">116</span> <span class="keyword">this</span>.context = <span class="built_in">document</span>;</span><br><span class="line"><span class="number">117</span> <span class="keyword">this</span>[<span class="number">0</span>] = <span class="built_in">document</span>.body;</span><br><span class="line"><span class="number">118</span> <span class="keyword">this</span>.selector = selector;</span><br><span class="line"><span class="number">119</span> <span class="keyword">this</span>.length = <span class="number">1</span>;</span><br><span class="line"><span class="number">120</span> <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line"><span class="number">121</span> &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="参数-selector-是其他字符串"><a href="#参数-selector-是其他字符串" class="headerlink" title="参数 selector 是其他字符串"></a>参数 selector 是其他字符串</h3><p>如果参数 selector 是其他字符串，则先检测 selector 是 HTML 代码还是 #id。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">123</span> <span class="comment">// Handle HTML strings</span></span><br><span class="line"><span class="number">124</span> <span class="keyword">if</span> ( <span class="keyword">typeof</span> selector === <span class="string">"string"</span> ) &#123;</span><br><span class="line"><span class="number">125</span> <span class="comment">// Are we dealing with HTML string or an ID?</span></span><br><span class="line"><span class="number">126</span> <span class="keyword">if</span> ( selector.charAt(<span class="number">0</span>) === <span class="string">"&lt;"</span> &amp;&amp; selector.charAt( selector.length - <span class="number">1</span> ) === <span class="string">"&gt;"</span> &amp;&amp; selector.length &gt;= <span class="number">3</span> ) &#123;</span><br><span class="line"><span class="number">127</span> <span class="comment">// Assume that strings that start and end with &lt;&gt; are HTML and skip the regex check</span></span><br><span class="line"><span class="number">128</span>   match = [ <span class="literal">null</span>, selector, <span class="literal">null</span> ];</span><br><span class="line"><span class="number">130</span> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="number">131</span>   match = quickExpr.exec( selector );</span><br><span class="line"><span class="number">132</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>第 126 ～ 128 行：如果参数 selector 以“ &lt;”开头、以“ &gt;”结尾，且长度大于等于 3，则假设这个字符串是 HTML 片段，跳过正则 quickExpr 的检查。注意这里仅仅是假设，并不一定表示它是真正合法的 HTML 代码，如“<code>&lt;div&gt;&lt;/p&gt;</code>”。</p>
<p>第 131 行：否则，用正则 quickExpr 检测参数 selector 是否是稍微复杂一些的 HTML 代码（如“<code>abc&lt;div&gt;</code>”）或 #id，匹配结果存放在数组 match 中。正则 quickExpr 的定义如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">39</span> <span class="comment">// A simple way to check for HTML strings or ID strings</span></span><br><span class="line"><span class="number">40</span> <span class="comment">// Prioritize #id over &lt;tag&gt; to avoid XSS via location.hash (#9521)</span></span><br><span class="line"><span class="number">41</span> quickExpr = <span class="regexp">/^(?:[^ # &lt;]*(&lt;[\w\W]+&gt;)[^&gt;]*$|#([\w\-]*)$)/</span>,</span><br></pre></td></tr></table></figure></p>
<p>正则 quickExpr 包含两个分组，依次匹配 HTML 代码和 id。如果匹配成功，则数组match 的第一个元素为参数 selector，第二个元素为匹配的 HTML 代码或 undefined，第三个元素为匹配的 id 或 undefined。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">quickExpr.exec( <span class="string">'#target'</span> );  <span class="comment">// ["#target", undefined, "target"]</span></span><br><span class="line">quickExpr.exec( <span class="string">'&lt;div&gt;'</span> );  <span class="comment">// ["&lt;div&gt;", "&lt;div&gt;", undefined]</span></span><br><span class="line">quickExpr.exec( <span class="string">'abc&lt;div&gt;'</span> );  <span class="comment">// ["abc&lt;div&gt;", "&lt;div&gt;", undefined]</span></span><br><span class="line">quickExpr.exec( <span class="string">'abc&lt;div&gt;abc#id'</span> );  <span class="comment">// ["abc&lt;div&gt;abc#id", "&lt;div&gt;", undefined]</span></span><br><span class="line">quickExpr.exec( <span class="string">'div'</span> ); <span class="comment">// null</span></span><br><span class="line">quickExpr.exec( <span class="string">'&lt;div&gt;&lt;img&gt;&lt;/div&gt;'</span> );  <span class="comment">// ["&lt;div&gt;&lt;img&gt;&lt;/div&gt;", "&lt;div&gt;&lt;img&gt;&lt;/div&gt;", undefined]</span></span><br></pre></td></tr></table></figure></p>
<p>第 41 行第一个 # 的特殊之处在于，在 jQuery 1.6.3 和之后的版本中，为了避免基于 location.hash 的 XSS 攻击，于是在 quickExpr 中增加了 # 。</p>
<p>在 jQuery 1.6.3 和之后的版本中，quickExpr 匹配 selector 时如果遇到“ #”，则认为不是HTML 代码，而是 #id，然后尝试调用 document.getElementById() 查找与之匹配的元素。而在 jQuery 1.6.3 之前的版本中，则只检查左尖括号和右尖括号，如果匹配则认为是 HTML 代码，并尝试创建 DOM 元素，这可能会导致恶意的 XSS 攻击。</p>
<p>假设有下面的场景：<br>在应用代码中出现 $( location.hash )，即根据 location.hash 的值来执行不同的逻辑，而用户可以自行在浏览器地址栏中修改 hash 值为“ <code>#&lt;img src=/ onerror=alert(1)&gt;</code>”，并重新打开这个页面；此时 $( location.hash ) 在执行时变为 <code>$(&#39;#&lt;img src=/ onerror=alert(1)&gt;&#39;)</code>。在 jQuery1.6.3 之前，“ <code>#&lt;img src=/ onerror=alert(1)&gt;</code>”被认为是 HTML 代码并创建 img 元素，因为属性src 指向的图片地址并不存在，事件句柄 onerror 被执行并弹出 1。这样一来，攻击者就可以在事件句柄 onerror 中编写恶意的 JavaScript 代码，例如，读取用户 cookie、发起 Ajax 请求等。</p>
<p>关于jQuery XSS，更多信息可以访问：</p>
<ul>
<li><a href="http://bugs.jquery.com/ticket/9521" target="_blank" rel="noopener">http://bugs.jquery.com/ticket/9521</a></li>
<li><a href="http://ma.la/jquery_xss/" target="_blank" rel="noopener">http://ma.la/jquery_xss/</a></li>
</ul>
<h4 id="参数-selector-是单独标签"><a href="#参数-selector-是单独标签" class="headerlink" title="参数 selector 是单独标签"></a>参数 selector 是单独标签</h4><p>如果参数 selector 是单独标签，则调用 document.createElement() 创建标签对应的 DOM 元素。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">134</span> <span class="comment">// Verify a match, and that no context was specified for #id</span></span><br><span class="line"><span class="number">135</span> <span class="keyword">if</span> ( match &amp;&amp; (match[<span class="number">1</span>] || !context) ) &#123;</span><br><span class="line"><span class="number">136</span></span><br><span class="line"><span class="number">137</span> <span class="comment">// HANDLE: $(html) -&gt; $(array)</span></span><br><span class="line"><span class="number">138</span> <span class="keyword">if</span> ( match[<span class="number">1</span>] ) &#123;</span><br><span class="line"><span class="number">139</span> context = context <span class="keyword">instanceof</span> jQuery ? context[<span class="number">0</span>] : context;</span><br><span class="line"><span class="number">140</span> doc = ( context ? context.ownerDocument || context : <span class="built_in">document</span> );</span><br><span class="line"><span class="number">141</span></span><br><span class="line"><span class="number">142</span> <span class="comment">// If a single string is passed in and it's a single tag</span></span><br><span class="line"><span class="number">143</span> <span class="comment">// just do a createElement and skip the rest</span></span><br><span class="line"><span class="number">144</span> ret = rsingleTag.exec( selector );</span><br><span class="line"><span class="number">145</span></span><br><span class="line"><span class="number">146</span> <span class="keyword">if</span> ( ret ) &#123;</span><br><span class="line"><span class="number">147</span> <span class="keyword">if</span> ( jQuery.isPlainObject( context ) ) &#123;</span><br><span class="line"><span class="number">148</span> selector = [ <span class="built_in">document</span>.createElement( ret[<span class="number">1</span>] ) ];</span><br><span class="line"><span class="number">149</span> jQuery.fn.attr.call( selector, context, <span class="literal">true</span> );</span><br><span class="line"><span class="number">150</span></span><br><span class="line"><span class="number">151</span> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="number">152</span> selector = [ doc.createElement( ret[<span class="number">1</span>] ) ];</span><br><span class="line"><span class="number">153</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>第 135 行：检测正则 quickExpr 匹配参数 selector 的结果，如果 match[1] 不是 undefined，即参数 selector 是 HTML 代码，或者 match[2] 不是 undefined，即参数 selector 是 #id，并且未传入参数 context。这行代码利用布尔表达式的计算顺序，省略了对 match[2] 的判断，完整的表达式如下：<br><code>if ( match &amp;&amp; (match[1] || match[2] &amp;&amp; !context) ) {</code><br>如果 match 不是 null 且 match[1] 是 undefined，那么此时 match[2] 必然不是 undefined，所以对 match[2] 的判断可以省略。</p>
<p>第 138 ～ 140 行：开始处理参数 selector 是 HTML 代码的情况，先修正 context、doc，然后用正则 rsingleTag 检测 HTML 代码是否是单独标签，匹配结果存放在数组 ret 中。正则rsingleTag 的定义如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">50</span> <span class="comment">// Match a standalone tag</span></span><br><span class="line"><span class="number">51</span> rsingleTag = <span class="regexp">/^&lt;(\w+)\s*\/?&gt;(?:&lt;\/\1&gt;)?$/</span>,</span><br></pre></td></tr></table></figure></p>
<p>正则 rsingleTag 包含一个分组“ (\w+)”，该分组中不包含左右尖括号、不能包含属性、可以自关闭或不关闭；“\1”指向匹配的第一个分组“(\w+)”。</p>
<p>第 146 ～ 153 行：如果数组 ret 不是 null，则认为参数 selector 是单独标签，调用 document.createElement() 创建标签对应的 DOM 元素；如果参数 context 是普通对象，则调用jQuery 方法 .attr() 并传入参数 context，同时把参数 ontext 中的属性、事件设置到新创建的DOM 元素上。</p>
<p>之所以把创建的 DOM 元素放入数组中，是为了在后面第 160 行方便地调用 jQuery.merge() 方法。方法 jQuery.merge() 用于合并两个数组的元素到第一个数组。</p>
<p>方法 .attr() 遇到特殊属性和事件类型属性时会执行同名的 jQuery 方法，方法 jQuery.isPlainObject() 用于检测对象是否是“纯粹”的对象，即用对象直接量 {} 或 new Object() 创建的对象。</p>
<h4 id="参数-selector-是复杂-HTML-代码"><a href="#参数-selector-是复杂-HTML-代码" class="headerlink" title="参数 selector 是复杂 HTML 代码"></a>参数 selector 是复杂 HTML 代码</h4><p>如果参数 selector 是复杂 HTML 代码，则利用浏览器的 innerHTML 机制创建 DOM 元素。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">155</span> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="number">156</span> ret = jQuery.buildFragment( [ match[<span class="number">1</span>] ], [ doc ] );</span><br><span class="line"><span class="number">157</span> selector = ( ret.cacheable ? jQuery.clone(ret.fragment):ret.fragment ).childNodes;</span><br><span class="line"><span class="number">158</span> &#125;</span><br><span class="line"><span class="number">159</span></span><br><span class="line"><span class="number">160</span> <span class="keyword">return</span> jQuery.merge( <span class="keyword">this</span>, selector );</span><br></pre></td></tr></table></figure></p>
<p>第 156 行：创建过程由方法 jQuery.buildFragment() 和 jQuery.clean() 实现，方法 jQuery.buildFragment() 返回值的格式为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">fragment: 含有转换后的 DOM 元素的文档片段</span><br><span class="line">cacheable: HTML 代码是否满足缓存条件</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>第 157 行：如果 HTML 代码满足缓存条件，则在使用转换后的 DOM 元素时，必须先复制一份再使用，否则可以直接使用。<br>第 160 行：将新创建的 DOM 元素数组合并到当前 jQuery 对象中并返回。</p>
<h4 id="参数-selector-是“-id”，且未指定参数-context"><a href="#参数-selector-是“-id”，且未指定参数-context" class="headerlink" title="参数 selector 是“#id”，且未指定参数 context"></a>参数 selector 是“#id”，且未指定参数 context</h4><p>如果参数 selector 是“ #id”，且未指定参数 context，则调用 document.getElementById()查找含有指定 id 属性的 DOM 元素。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">162</span> <span class="comment">// HANDLE: $("#id")</span></span><br><span class="line"><span class="number">163</span> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="number">164</span> elem = <span class="built_in">document</span>.getElementById( match[<span class="number">2</span>] );</span><br><span class="line"><span class="number">165</span></span><br><span class="line"><span class="number">166</span> <span class="comment">// Check parentNode to catch when Blackberry 4.6 returns</span></span><br><span class="line"><span class="number">167</span> <span class="comment">// nodes that are no longer in the document #6963</span></span><br><span class="line"><span class="number">168</span> <span class="keyword">if</span> ( elem &amp;&amp; elem.parentNode ) &#123;</span><br><span class="line"><span class="number">169</span> <span class="comment">// Handle the case where IE and Opera return items</span></span><br><span class="line"><span class="number">170</span> <span class="comment">// by name instead of ID</span></span><br><span class="line"><span class="number">171</span> <span class="keyword">if</span> ( elem.id !== match[<span class="number">2</span>] ) &#123;</span><br><span class="line"><span class="number">172</span> <span class="keyword">return</span> rootjQuery.find( selector );</span><br><span class="line"><span class="number">173</span> &#125;</span><br><span class="line"><span class="number">174</span></span><br><span class="line"><span class="number">175</span> <span class="comment">// Otherwise, we inject the element directly into the jQuery object</span></span><br><span class="line"><span class="number">176</span> <span class="keyword">this</span>.length = <span class="number">1</span>;</span><br><span class="line"><span class="number">177</span> <span class="keyword">this</span>[<span class="number">0</span>] = elem;</span><br><span class="line"><span class="number">178</span> &#125;</span><br><span class="line"><span class="number">179</span></span><br><span class="line"><span class="number">180</span> <span class="keyword">this</span>.context = <span class="built_in">document</span>;</span><br><span class="line"><span class="number">181</span> <span class="keyword">this</span>.selector = selector;</span><br><span class="line"><span class="number">182</span> <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line"><span class="number">183</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>第 162 ～ 164 行：如果参数 selector 是“ #id”且未指定参数 context，则调用 document.getElementById() 查找含有指定 id 属性的 DOM 元素。<br>第 166 ～ 168 行：检查 parentNode 属性，因为 Blackberry 4.6 会返回已经不在文档中的DOM 节点。<br>第 169 ～ 173 行：如果所找到元素的属性 id 值与传入的值不相等，则调用 Sizzle 查找并返回一个含有选中元素的新 jQuery 对象。即使是 document.getElementById() 这样核心的方法也需要考虑浏览器兼容问题，在 IE 6、IE 7、某些版本的 Opera 中，可能会按属性 name 查找而不是 id。<br>第 175 ～ 182 行：如果所找到元素的属性 id 值与传入的值相等，则设置第一个元素、属性 length、context、selector，并返回当前 jQuery 对象。</p>
<h4 id="参数-selector-是选择器表达式"><a href="#参数-selector-是选择器表达式" class="headerlink" title="参数 selector 是选择器表达式"></a>参数 selector 是选择器表达式</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">185</span> <span class="comment">// HANDLE: $(expr, $(...))</span></span><br><span class="line"><span class="number">186</span> &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( !context || context.jquery ) &#123;</span><br><span class="line"><span class="number">187</span> <span class="keyword">return</span> ( context || rootjQuery ).find( selector );</span><br><span class="line"><span class="number">188</span></span><br><span class="line"><span class="number">189</span> <span class="comment">// HANDLE: $(expr, context)</span></span><br><span class="line"><span class="number">190</span> <span class="comment">// (which is just equivalent to: $(context).find(expr)</span></span><br><span class="line"><span class="number">191</span> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="number">192</span> <span class="keyword">return</span> <span class="keyword">this</span>.constructor( context ).find( selector );</span><br><span class="line"><span class="number">193</span> &#125;</span><br></pre></td></tr></table></figure>
<p>此时依然在字符串分支中，参数 selector 不是单独标签、复杂 HTML 代码、#id，而是选择器表达式。如果没有指定上下文，则执行 rootjQuery.find( selector )；如果指定了上下文，且上下文是 jQuery 对象，则执行 context.find( selector ) ；如果指定了上下文，但上下文不是jQuery 对象，则执行 this.constructor( context ).find( selector )，即先创建一个包含了 context 的jQuery 对象，然后在该 jQuery 对象上调用方法 .find()。</p>
<h3 id="参数-selector-是函数"><a href="#参数-selector-是函数" class="headerlink" title="参数 selector 是函数"></a>参数 selector 是函数</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">195</span> <span class="comment">// HANDLE: $(function)</span></span><br><span class="line"><span class="number">196</span> <span class="comment">// Shortcut for document ready</span></span><br><span class="line"><span class="number">197</span> &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( jQuery.isFunction( selector ) ) &#123;</span><br><span class="line"><span class="number">198</span> <span class="keyword">return</span> rootjQuery.ready( selector );</span><br><span class="line"><span class="number">199</span> &#125;</span><br></pre></td></tr></table></figure>
<p>第 197 ～ 199 行：如果参数 selector 是函数，则认为是绑定 ready 事件。从第 198 行代码可以看出 $( function ) 是 $( document ).ready( function ) 的简写。</p>
<h3 id="参数-selector-是-jQuery-对象"><a href="#参数-selector-是-jQuery-对象" class="headerlink" title="参数 selector 是 jQuery 对象"></a>参数 selector 是 jQuery 对象</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">201</span> <span class="keyword">if</span> ( selector.selector !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line"><span class="number">202</span> <span class="keyword">this</span>.selector = selector.selector;</span><br><span class="line"><span class="number">203</span> <span class="keyword">this</span>.context = selector.context;</span><br><span class="line"><span class="number">204</span> &#125;</span><br></pre></td></tr></table></figure>
<p>第 201 ～ 204 行：如果参数 selector 含有属性 selector，则认为它是 jQuery 对象，将会复制它的属性 selector 和 context。而且在其后的第 206 行会把参数 selector 中包含的选中元素引用，全部复制到当前 jQuery 对象中</p>
<h3 id="参数-selector-是任意其他值"><a href="#参数-selector-是任意其他值" class="headerlink" title="参数 selector 是任意其他值"></a>参数 selector 是任意其他值</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">206</span> <span class="keyword">return</span> jQuery.makeArray( selector, <span class="keyword">this</span> );</span><br><span class="line"><span class="number">207</span> &#125;,</span><br></pre></td></tr></table></figure>
<p>第 206 行：如果 selector 是数组或伪数组（如 jQuery 对象），则都添加到当前 jQuery 对象中；<br>如果 selector 是 JavaScript 对象，则作为第一个元素放入当前 jQuery 对象中；<br>如果是其他类型的值，则作为第一个元素放入当前 jQuery 对象中。最后返回当前 jQuery 对象。</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>方法 jQuery.fn.init( selector, context, rootjQuery ) 的 12 分支相关的判断和执行过程可以整理为图：<br><img src="2.png" alt="jQuery.fn.init( selector, context, rootjQuery ) 的 12 个分支"><br>jQuery.fn.init( selector, context, rootjQuery ) 的 12 个分支</p>
<hr>
<p>本系列笔记来自《jQuery技术内幕》一书中的部分内容。注意：其内的<strong>jQuery版本为1.7.1</strong>，后面的版本也许在一些方法和功能模块上有修改，了解其思想即可，但不可想当然的直接认定。</p>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2016/04/10/jquery-internals4/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Newer
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2016/04/10/jquery-internals2/" id="post_nav-older" class="next-content">
            Older
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>
    <!-- modified By KING 2017.11.16 -->
    <!-- Sidebar Avatar
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="KING's avatar">
    </div> -->

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        xmoyking@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="https://github.com/xmoyKing/xmoyKing.github.io" target="_blank" title="Star Me on GitHub">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">star</i>
                        
                        Star Me on GitHub
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                Home
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    Archives
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/04/">April 2018<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/03/">March 2018<span class="sidebar_archives-count">17</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/02/">February 2018<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/01/">January 2018<span class="sidebar_archives-count">10</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">December 2017<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">November 2017<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">October 2017<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">September 2017<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">August 2017<span class="sidebar_archives-count">13</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">July 2017<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/06/">June 2017<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/05/">May 2017<span class="sidebar_archives-count">15</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">April 2017<span class="sidebar_archives-count">15</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">March 2017<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/02/">February 2017<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/01/">January 2017<span class="sidebar_archives-count">18</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/12/">December 2016<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/11/">November 2016<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">October 2016<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">September 2016<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/08/">August 2016<span class="sidebar_archives-count">20</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">July 2016<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/06/">June 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/05/">May 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/04/">April 2016<span class="sidebar_archives-count">5</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                Categories
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Angular/">Angular<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/categories/AngularJS/">AngularJS<span class="sidebar_archives-count">50</span></a></li><li><a class="sidebar_archives-link" href="/categories/CSS/">CSS<span class="sidebar_archives-count">24</span></a></li><li><a class="sidebar_archives-link" href="/categories/Java/">Java<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/JavaScript/">JavaScript<span class="sidebar_archives-count">93</span></a></li><li><a class="sidebar_archives-link" href="/categories/Linux/">Linux<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Nodejs/">Nodejs<span class="sidebar_archives-count">16</span></a></li><li><a class="sidebar_archives-link" href="/categories/TypeScript/">TypeScript<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/WebApp/">WebApp<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/categories/jQuery/">jQuery<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/categories/linux/">linux<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/mixed/">mixed<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/categories/mongodb/">mongodb<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/python/">python<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/three-js/">three.js<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/区块链/">区块链<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/响应式-Web-设计/">响应式 Web 设计<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/安全/">安全<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/网络/">网络<span class="sidebar_archives-count">10</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="Tags">
                
                    <i class="material-icons sidebar-material-icons">bookmark</i>
                
                Tags
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
    
        <li>
            <a href="/2017/01/01/0_links/" title="Links">
                
                    <i class="material-icons sidebar-material-icons">polymer</i>
                
                Links
            </a>
        </li>
        
    
        <li>
            <a href="/2018/02/16/0_booklist/" title="Booklist">
                
                    <i class="material-icons sidebar-material-icons">code</i>
                
                Booklist
            </a>
        </li>
        
    
        <li>
            <a href="/2017/03/01/0_mixed/" title="Notes">
                
                    <i class="material-icons sidebar-material-icons">assignment</i>
                
                Notes
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                Number of articles
                <span class="sidebar-badge">259</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    
        <a href="https://plus.google.com/114920706759690760782" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    
        <a href="http://weibo.com/p/1005052419772155" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-weibo">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="http://github.com/xmoyking" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>KING · NOTE
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/js/lazyload.min.js", true)</script>



    <script>lsloader.load("js_js","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/js/js.min.js", true)</script>



    <script>lsloader.load("np_js","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/js/nprogress.js", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
