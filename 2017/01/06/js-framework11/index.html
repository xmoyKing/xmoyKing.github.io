<!DOCTYPE html>
<html style="display: none;" lang="en">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.0 -->
    <script>
        window.materialVersion = "1.5.0"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">

    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source"/>














    <!-- Title -->
    
    <title>
        
            JavaScript框架设计笔记-11-事件系统-2-jQuery事件系统 | 
        
        KING · NOTE
    </title>

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no"/>
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="KING">
    <meta name="description" itemprop="description" content="Loneliness is the carnival of one single soul.">
    <meta name="keywords" content=",JavaScript,jQuery,JavaScript框架设计,jquery.event">

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(window.oldVersion){var remove=window.oldVersion.reduce(function(p,c){return p||data.indexOf("/*"+c+"*/")!==-1},false);if(remove){lsloader.removeLS(key)}}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload,isJs){if(typeof cssonload==="boolean"){isJs=cssonload;cssonload=undefined}isJs=isJs||false;cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}code=code.split(versionString)[1];if(isJs){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload,isJs)}};lsloader.requestResource=function(name,path,cssonload,isJs){var that=this;if(isJs){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else{this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="KING · NOTE">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.en.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/css/material.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/css/style.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->
<!-- add By KING 2017.11.16 -->
<link rel="stylesheet" href="/css/highlightjs/vs.css">
<style>
  #scheme-Paradox .material-layout .highlight .meta{
    display: initial;
    padding: initial;
  }
</style>


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icon -->

    <style>
        @font-face {
            font-family: 'Material Icons';
            font-style: normal;
            font-weight: 400;
            src: local('Material Icons'),
            local('MaterialIcons-Regular'),
            url(https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/fonts/MaterialIcons-Regular.woff2) format('woff2'),
            url(https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/fonts/MaterialIcons-Regular.woff) format('woff'),
            url(https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/fonts/MaterialIcons-Regular.ttf) format('truetype');
        }
    </style>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/js/jquery.min.js", true)</script>
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://github.com/xmoyKING">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="JavaScript框架设计笔记-11-事件系统-2-jQuery事件系统 | KING · NOTE">
    <meta property="og:image" content="https://github.com/xmoyKING/img/favicon.png" />
    <meta property="og:description" content="Loneliness is the carnival of one single soul.">
    <meta property="og:article:tag" content="JavaScript"> <meta property="og:article:tag" content="jQuery"> <meta property="og:article:tag" content="JavaScript框架设计"> <meta property="og:article:tag" content="jquery.event"> 

    
        <meta property="article:published_time" content="Fri Jan 06 2017 19:31:10 GMT+0800" />
        <meta property="article:modified_time" content="Fri Jan 06 2017 19:31:10 GMT+0800" />
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="JavaScript框架设计笔记-11-事件系统-2-jQuery事件系统 | KING · NOTE">
    <meta name="twitter:description" content="Loneliness is the carnival of one single soul.">
    <meta name="twitter:image" content="https://github.com/xmoyKING/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://github.com/xmoyKING" />

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://github.com/xmoyKING/2017/01/06/js-framework11/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "https://github.com/xmoyKING/2017/01/06/js-framework11/index.html",
    "headline": "JavaScript框架设计笔记-11-事件系统-2-jQuery事件系统",
    "datePublished": "Fri Jan 06 2017 19:31:10 GMT+0800",
    "dateModified": "Fri Jan 06 2017 19:31:10 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "KING",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.png"
        },
        "description": "Loneliness is the carnival of one single soul."
    },
    "publisher": {
        "@type": "Organization",
        "name": "KING · NOTE",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",JavaScript,jQuery,JavaScript框架设计,jquery.event",
    "description": "Loneliness is the carnival of one single soul.",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#jquery1-8事件模块概览"><span class="post-toc-number">1.</span> <span class="post-toc-text">jquery1.8事件模块概览</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#jQuery-event-add源码解读"><span class="post-toc-number">2.</span> <span class="post-toc-text">jQuery.event.add源码解读</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#jQuery-event-remove的源码解读"><span class="post-toc-number">3.</span> <span class="post-toc-text">jQuery.event.remove的源码解读</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#jQuery-event-dispatch源码解读"><span class="post-toc-number">4.</span> <span class="post-toc-text">jQuery.event.dispatch源码解读</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#jQuery-event-trigger源码解读"><span class="post-toc-number">5.</span> <span class="post-toc-text">jQuery.event.trigger源码解读</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                JavaScript框架设计笔记-11-事件系统-2-jQuery事件系统
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>KING</strong>
        <span>Jan 06, 2017</span>
        <!-- Updated Time , add By KING 2017.11.16 -->
        <span>Jan 06, 2017 UPDATED</span> 
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/JavaScript/">JavaScript</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/JavaScript框架设计/">JavaScript框架设计</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/jQuery/">jQuery</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/jquery-event/">jquery.event</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=JavaScript框架设计笔记-11-事件系统-2-jQuery事件系统&url=https://github.com/xmoyKING/2017/01/06/js-framework11/index.html&pic=https://github.com/xmoyKING/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                Share to Weibo
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=JavaScript框架设计笔记-11-事件系统-2-jQuery事件系统&url=https://github.com/xmoyKING/2017/01/06/js-framework11/index.html&via=KING" target="_blank">
            <li class="mdl-menu__item">
                Share to Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://github.com/xmoyKING/2017/01/06/js-framework11/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://github.com/xmoyKING/2017/01/06/js-framework11/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h4 id="jquery1-8事件模块概览"><a href="#jquery1-8事件模块概览" class="headerlink" title="jquery1.8事件模块概览"></a>jquery1.8事件模块概览</h4><p><a href="https://github.com/jquery/jquery/blob/1.8.3/src/event.js">源码地址</a></p>
<p>如下list为<a href="http://www.css88.com/jqapi-1.9/" target="_blank" rel="noopener">jquery1.8的事件模块API</a>，从参考API列表中可以看到API的演变和示例用法。</p>
<p>浏览器事件<br>.error() <em>弃用</em><br>.resize()<br>.scroll()<br>文档加载<br>.holdReady()<br>.load() <em>弃用</em><br>.ready()<br>.unload() <em>弃用</em><br>事件绑定<br>.bind()<br>.delegate()<br>.die() <em>弃用</em><br>.live() <em>弃用</em><br>.off()<br>.on()<br>.one()<br>.trigger()<br>.triggerHandler()<br>.unbind()<br>.undelegate()</p>
<p>表单事件<br>.blur()<br>.change()<br>.focus()<br>.select()<br>.submit()<br>键盘事件<br>.keydown()<br>.keypress()<br>.keyup()<br>鼠标事件<br>.click()<br>.contextmenu()<br>.dblclick()<br>.focusin()<br>.focusout()<br>.hover()<br>.mousedown()<br>.mouseenter()<br>.mouseleave()<br>.mousemove()<br>.mouseout()<br>.mouseover()<br>.mouseup()<br>.toggle() <em>弃用</em></p>
<h4 id="jQuery-event-add源码解读"><a href="#jQuery-event-add源码解读" class="headerlink" title="jQuery.event.add源码解读"></a>jQuery.event.add源码解读</h4><p>add方法的主要目的是将用户的所有传递参数，并成一个handleObj对象放到元素对应的缓存体中的events对象的某个队列中，然后绑定一个回调，这个回调会处理用户的所有回调，因此对于每一个元素每一种事件，它只绑定一次。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">add: <span class="function"><span class="keyword">function</span>(<span class="params"> elem, types, handler, data, selector </span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> elemData, eventHandle, events,</span><br><span class="line">    t, tns, type, namespaces, handleObj,</span><br><span class="line">    handleObjIn, handlers, special;</span><br><span class="line">  <span class="comment">// 若elem不能添加自定义属性（IE下访问文本节点会报错）因此事件源不能为文本节点</span></span><br><span class="line">  <span class="comment">// 注释节点本来就不应该绑定事件，而注释节点能被获取到是因为jquery的html方法</span></span><br><span class="line">  <span class="comment">// 若没有指定事件类型或回调则立即返回</span></span><br><span class="line">  <span class="comment">// Don't attach events to noData or text/comment nodes (allow plain objects tho)</span></span><br><span class="line">  <span class="keyword">if</span> ( elem.nodeType === <span class="number">3</span> || elem.nodeType === <span class="number">8</span> || !types || !handler || !(elemData = jQuery._data( elem )) ) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 取得用户回调与CSS表达式，handleObjeIn这种结构称为事件描述</span></span><br><span class="line">  <span class="comment">// 记录了用户绑定此回调时的各种信息，方便用于“事件copy”</span></span><br><span class="line">  <span class="comment">// Caller can pass in an object of custom data in lieu of the handler</span></span><br><span class="line">  <span class="keyword">if</span> ( handler.handler ) &#123;</span><br><span class="line">    handleObjIn = handler;</span><br><span class="line">    handler = handleObjIn.handler;</span><br><span class="line">    selector = handleObjIn.selector;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 确保回调拥有UUID，用于查找或移除</span></span><br><span class="line">  <span class="comment">// Make sure that the handler has a unique ID, used to find/remove it later</span></span><br><span class="line">  <span class="keyword">if</span> ( !handler.guid ) &#123;</span><br><span class="line">    handler.guid = jQuery.guid++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 此元素在数据缓存系统中开辟一个叫event的空间来保存所有回调与事件处理器</span></span><br><span class="line">  <span class="comment">// Init the element's event structure and main handler, if this is the first</span></span><br><span class="line">  events = elemData.events;</span><br><span class="line">  <span class="keyword">if</span> ( !events ) &#123;</span><br><span class="line">    elemData.events = events = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  eventHandle = elemData.handle; <span class="comment">// 事件处理器</span></span><br><span class="line">  <span class="keyword">if</span> ( !eventHandle ) &#123;</span><br><span class="line">    elemData.handle = eventHandle = <span class="function"><span class="keyword">function</span>(<span class="params"> e </span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 用户在事件冒泡时，被二次fire或在页面unload后触发事件</span></span><br><span class="line">      <span class="comment">// Discard the second event of a jQuery.event.trigger() and</span></span><br><span class="line">      <span class="comment">// when an event is called after a page has unloaded</span></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">typeof</span> jQuery !== <span class="string">"undefined"</span> &amp;&amp; (!e || jQuery.event.triggered !== e.type) ?</span><br><span class="line">        jQuery.event.dispatch.apply( eventHandle.elem, <span class="built_in">arguments</span> ) :</span><br><span class="line">        <span class="literal">undefined</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 明确this的指向，防止IE下原生事件内存泄漏</span></span><br><span class="line">    <span class="comment">// Add elem as a property of the handle fn to prevent a memory leak with IE non-native events</span></span><br><span class="line">    eventHandle.elem = elem;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 通过空格隔开同时绑定多个事件，比如"mouseover mouseout"</span></span><br><span class="line">  <span class="comment">// Handle multiple events separated by a space</span></span><br><span class="line">  <span class="comment">// jQuery(...).bind("mouseover mouseout", fn);</span></span><br><span class="line">  types = jQuery.trim( hoverHack(types) ).split( <span class="string">" "</span> );</span><br><span class="line">  <span class="keyword">for</span> ( t = <span class="number">0</span>; t &lt; types.length; t++ ) &#123;</span><br><span class="line"></span><br><span class="line">    tns = rtypenamespace.exec( types[t] ) || []; <span class="comment">// 取得命名空间</span></span><br><span class="line">    type = tns[<span class="number">1</span>]; <span class="comment">// 取得真正的事件</span></span><br><span class="line">    namespaces = ( tns[<span class="number">2</span>] || <span class="string">""</span> ).split( <span class="string">"."</span> ).sort(); <span class="comment">// 修正命名控件</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 并不是所有事件都能直接使用，比如FF下没有mousewheel，需要用DOMMouseScroll模拟</span></span><br><span class="line">    <span class="comment">// If event changes its type, use the special event handlers for the changed type</span></span><br><span class="line">    special = jQuery.event.special[ type ] || &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 有时候需要在事件代理时进行模拟，比如FF下focus、blur</span></span><br><span class="line">    <span class="comment">// If selector defined, determine special event api type, otherwise given type</span></span><br><span class="line">    type = ( selector ? special.delegateType : special.bindType ) || type;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update special based on newly reset type</span></span><br><span class="line">    special = jQuery.event.special[ type ] || &#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 构建一个事件描述对象</span></span><br><span class="line">    <span class="comment">// handleObj is passed to all event handlers</span></span><br><span class="line">    handleObj = jQuery.extend(&#123;</span><br><span class="line">      type: type,</span><br><span class="line">      origType: tns[<span class="number">1</span>],</span><br><span class="line">      data: data,</span><br><span class="line">      handler: handler,</span><br><span class="line">      guid: handler.guid,</span><br><span class="line">      selector: selector,</span><br><span class="line">      needsContext: selector &amp;&amp; jQuery.expr.match.needsContext.test( selector ),</span><br><span class="line">      namespace: namespaces.join(<span class="string">"."</span>)</span><br><span class="line">    &#125;, handleObjIn );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在events对象上分别存储事件描述，每种事件对应一个数组</span></span><br><span class="line">    <span class="comment">// 每种事件只绑定一次监听器</span></span><br><span class="line">    <span class="comment">// Init the event handler queue if we're the first</span></span><br><span class="line">    handlers = events[ type ];</span><br><span class="line">    <span class="keyword">if</span> ( !handlers ) &#123;</span><br><span class="line">      handlers = events[ type ] = [];</span><br><span class="line">      handlers.delegateCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 若存在special.setup并且返回0时才直接使用多投事件API</span></span><br><span class="line">      <span class="comment">// Only use addEventListener/attachEvent if the special events handler returns false</span></span><br><span class="line">      <span class="keyword">if</span> ( !special.setup || special.setup.call( elem, data, namespaces, eventHandle ) === <span class="literal">false</span> ) &#123;</span><br><span class="line">        <span class="comment">// Bind the global event handler to the element</span></span><br><span class="line">        <span class="keyword">if</span> ( elem.addEventListener ) &#123;</span><br><span class="line">          elem.addEventListener( type, eventHandle, <span class="literal">false</span> );</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> ( elem.attachEvent ) &#123;</span><br><span class="line">          elem.attachEvent( <span class="string">"on"</span> + type, eventHandle );</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理自定义事件</span></span><br><span class="line">    <span class="keyword">if</span> ( special.add ) &#123;</span><br><span class="line">      special.add.call( elem, handleObj );</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> ( !handleObj.handler.guid ) &#123;</span><br><span class="line">        handleObj.handler.guid = handler.guid;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 若使用事件代理，则将事件描述放到数组最前面</span></span><br><span class="line">    <span class="comment">// Add to the element's handler list, delegates in front</span></span><br><span class="line">    <span class="keyword">if</span> ( selector ) &#123;</span><br><span class="line">      handlers.splice( handlers.delegateCount++, <span class="number">0</span>, handleObj );</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      handlers.push( handleObj );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 用于jQuery.event.trigger，若此事件从未绑定过，也没必要进入trigger的真正处理逻辑</span></span><br><span class="line">    <span class="comment">// Keep track of which events have ever been used, for event optimization</span></span><br><span class="line">    jQuery.event.global[ type ] = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 防止IE内存泄漏</span></span><br><span class="line">  <span class="comment">// Nullify elem to prevent memory leaks in IE</span></span><br><span class="line">  elem = <span class="literal">null</span>;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>上述代码中，jquery的回调不直接与元素挂钩，而是通过UUID访问数据缓存系统，获取对应的events对象，在根据事件类型得到一组事件描述，并且，事件描述里没有事件源的记录，方便事件克隆。其中数据缓存系统是关键，事件代理对数据缓存依赖非常严重。</p>
<h4 id="jQuery-event-remove的源码解读"><a href="#jQuery-event-remove的源码解读" class="headerlink" title="jQuery.event.remove的源码解读"></a>jQuery.event.remove的源码解读</h4><p>remove方法根据用户传参，找到事件队列，从里面把匹配的handleObj对象移除，在参数不足的情况，可能移除多个甚至所有。当队列长度为零时移除事件，当events为空对象则清除UUID。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Detach an event or set of events from an element</span></span><br><span class="line">remove: <span class="function"><span class="keyword">function</span>(<span class="params"> elem, types, handler, selector, mappedTypes </span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> t, tns, type, origType, namespaces, origCount,</span><br><span class="line">    j, events, special, eventType, handleObj,</span><br><span class="line">    elemData = jQuery.hasData( elem ) &amp;&amp; jQuery._data( elem );</span><br><span class="line">  <span class="comment">// 若不支持添加自定义属性或没有缓存与事件有关的东西，立即返回</span></span><br><span class="line">  <span class="keyword">if</span> ( !elemData || !(events = elemData.events) ) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 按空格进行切割，方便移除多种事件类型，比如hover转换为“mouseenter mouseleave”，</span></span><br><span class="line">  <span class="comment">// Once for each type.namespace in types; type may be omitted</span></span><br><span class="line">  types = jQuery.trim( hoverHack( types || <span class="string">""</span> ) ).split(<span class="string">" "</span>);</span><br><span class="line">  <span class="keyword">for</span> ( t = <span class="number">0</span>; t &lt; types.length; t++ ) &#123;</span><br><span class="line">    tns = rtypenamespace.exec( types[t] ) || [];</span><br><span class="line">    type = origType = tns[<span class="number">1</span>]; <span class="comment">// 取得事件类型</span></span><br><span class="line">    namespaces = tns[<span class="number">2</span>]; <span class="comment">// 取得命名空间</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 若没有指定事件类型，则移除所有事件类型或移除所有与此命名空间有关的事件类型</span></span><br><span class="line">    <span class="comment">// Unbind all events (on this namespace, if provided) for the element</span></span><br><span class="line">    <span class="keyword">if</span> ( !type ) &#123;</span><br><span class="line">      <span class="keyword">for</span> ( type <span class="keyword">in</span> events ) &#123;</span><br><span class="line">        jQuery.event.remove( elem, type + types[ t ], handler, selector, <span class="literal">true</span> );</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 利用事件模拟，取得真正用于绑定的事件类型</span></span><br><span class="line">    special = jQuery.event.special[ type ] || &#123;&#125;;</span><br><span class="line">    type = ( selector? special.delegateType : special.bindType ) || type;</span><br><span class="line">    eventType = events[ type ] || []; <span class="comment">// 取得装载事件描述对象的数组</span></span><br><span class="line">    origCount = eventType.length;</span><br><span class="line">    <span class="comment">// 取得用于过滤命名空间的正则，没有则为null</span></span><br><span class="line">    namespaces = namespaces ? <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"(^|\\.)"</span> + namespaces.split(<span class="string">"."</span>).sort().join(<span class="string">"\\.(?:.*\\.|)"</span>) + <span class="string">"(\\.|$)"</span>) : <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 移除所有符合条件的事件描述对象</span></span><br><span class="line">    <span class="comment">// Remove matching events</span></span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; eventType.length; j++ ) &#123;</span><br><span class="line">      handleObj = eventType[ j ];</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> ( ( mappedTypes || origType === handleObj.origType ) &amp;&amp;  <span class="comment">// 比较事件类型是否一致</span></span><br><span class="line">          ( !handler || handler.guid === handleObj.guid ) &amp;&amp; <span class="comment">// 若传了回调，判断UUID是否相同</span></span><br><span class="line">          ( !namespaces || namespaces.test( handleObj.namespace ) ) &amp;&amp;</span><br><span class="line">          <span class="comment">// 若types含有命名空间，用正则看是否匹配</span></span><br><span class="line">          <span class="comment">// 若是事件代理则必须有css表达式，比较与事件描述对象中的是否相等</span></span><br><span class="line">          ( !selector || selector === handleObj.selector || selector === <span class="string">"**"</span> &amp;&amp; handleObj.selector ) ) &#123;</span><br><span class="line">        eventType.splice( j--, <span class="number">1</span> ); <span class="comment">// 移除</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( handleObj.selector ) &#123; <span class="comment">// delegateCount减1</span></span><br><span class="line">          eventType.delegateCount--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( special.remove ) &#123; <span class="comment">// 处理个别事件的移除</span></span><br><span class="line">          special.remove.call( elem, handleObj );</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 若已经移除所有此类型的回调，则卸载框架绑定的elemData.handle</span></span><br><span class="line">    <span class="comment">// origCount !== eventType.length是为了防止死循环</span></span><br><span class="line">    <span class="comment">// Remove generic event handler if we removed something and no more handlers exist</span></span><br><span class="line">    <span class="comment">// (avoids potential for endless recursion during removal of special event handlers)</span></span><br><span class="line">    <span class="keyword">if</span> ( eventType.length === <span class="number">0</span> &amp;&amp; origCount !== eventType.length ) &#123;</span><br><span class="line">      <span class="keyword">if</span> ( !special.teardown || special.teardown.call( elem, namespaces, elemData.handle ) === <span class="literal">false</span> ) &#123;</span><br><span class="line">        jQuery.removeEvent( elem, type, elemData.handle );</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">delete</span> events[ type ];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 若events为空，则从elemData中删除events与handler</span></span><br><span class="line">  <span class="comment">// Remove the expando if it's no longer used</span></span><br><span class="line">  <span class="keyword">if</span> ( jQuery.isEmptyObject( events ) ) &#123;</span><br><span class="line">    <span class="keyword">delete</span> elemData.handle;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// removeData also checks for emptiness and clears the expando if empty</span></span><br><span class="line">    <span class="comment">// so use it instead of delete</span></span><br><span class="line">    jQuery.removeData( elem, <span class="string">"events"</span>, <span class="literal">true</span> );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>卸载部分是事件系统中最简单的部分，主要逻辑花在移除事件描述对象的匹配条件。</p>
<h4 id="jQuery-event-dispatch源码解读"><a href="#jQuery-event-dispatch源码解读" class="headerlink" title="jQuery.event.dispatch源码解读"></a>jQuery.event.dispatch源码解读</h4><p>事件系统的核心，利用dispatch方法，从缓存体中的events对象获取对应队列，然后修复事件对象，逐个传入用户的回调中执行，根据返回值决定是否断开循环（stopImmediatePropagation）、阻止默认行为和事件传播。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">dispatch: <span class="function"><span class="keyword">function</span>(<span class="params"> event </span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 创建一个伪事件对象（jQuery.Event实例），从真正的事件对象上抽取响应的属性附于其上</span></span><br><span class="line">  <span class="comment">// 若是IE，也可将它们转换成对应的W3C属性，弥补差异</span></span><br><span class="line">  <span class="comment">// Make a writable jQuery.Event from the native event object</span></span><br><span class="line">  event = jQuery.event.fix( event || <span class="built_in">window</span>.event );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> i, j, cur, ret, selMatch, matched, matches, handleObj, sel, related,</span><br><span class="line">    <span class="comment">// 取得所有事件描述对象</span></span><br><span class="line">    handlers = ( (jQuery._data( <span class="keyword">this</span>, <span class="string">"events"</span> ) || &#123;&#125; )[ event.type ] || []),</span><br><span class="line">    delegateCount = handlers.delegateCount,</span><br><span class="line">    args = core_slice.call( <span class="built_in">arguments</span> ),</span><br><span class="line">    run_all = !event.exclusive &amp;&amp; !event.namespace,</span><br><span class="line">    special = jQuery.event.special[ event.type ] || &#123;&#125;,</span><br><span class="line">    handlerQueue = [];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 重置第一个参数为jQuery.Event实例</span></span><br><span class="line">  <span class="comment">// Use the fix-ed jQuery.Event rather than the (read-only) native event</span></span><br><span class="line">  args[<span class="number">0</span>] = event;</span><br><span class="line">  event.delegateTarget = <span class="keyword">this</span>; <span class="comment">// 添加一个人为属性，用于事件代理</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 执行preDispatch回调，它与后面的postDIspatch构成一种类似AOP的机制</span></span><br><span class="line">  <span class="comment">// Call the preDispatch hook for the mapped type, and let it bail if desired</span></span><br><span class="line">  <span class="keyword">if</span> ( special.preDispatch &amp;&amp; special.preDispatch.call( <span class="keyword">this</span>, event ) === <span class="literal">false</span> ) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 若是事件代理，并且不是来自于非左键的点击事件</span></span><br><span class="line">  <span class="comment">// Determine handlers that should run if there are delegated events</span></span><br><span class="line">  <span class="comment">// Avoid non-left-click bubbling in Firefox (#3861)</span></span><br><span class="line">  <span class="keyword">if</span> ( delegateCount &amp;&amp; !(event.button &amp;&amp; event.type === <span class="string">"click"</span>) ) &#123;</span><br><span class="line">    <span class="comment">// 从事件源开始，遍历其所有祖先一直到绑定事件的元素</span></span><br><span class="line">    <span class="keyword">for</span> ( cur = event.target; cur != <span class="keyword">this</span>; cur = cur.parentNode || <span class="keyword">this</span> ) &#123;</span><br><span class="line">      <span class="comment">// 不触发disabled的元素的点击事件</span></span><br><span class="line">      <span class="comment">// Don't process clicks (ONLY) on disabled elements (#6911, #8165, #11382, #11764)</span></span><br><span class="line">      <span class="keyword">if</span> ( cur.disabled !== <span class="literal">true</span> || event.type !== <span class="string">"click"</span> ) &#123;</span><br><span class="line">        selMatch = &#123;&#125;; <span class="comment">// 每种CSS表达式只判断1次，</span></span><br><span class="line">        matches = []; <span class="comment">// 用于收集符合条件的事件描述对象</span></span><br><span class="line">        <span class="comment">// 使用事件代理的事件描述对象总是排在前面</span></span><br><span class="line">        <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; delegateCount; i++ ) &#123;</span><br><span class="line">          handleObj = handlers[ i ];</span><br><span class="line">          sel = handleObj.selector;</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> ( selMatch[ sel ] === <span class="literal">undefined</span> ) &#123;</span><br><span class="line">            <span class="comment">// 有多少个元素匹配就收集多少个事件描述对象</span></span><br><span class="line">            selMatch[ sel ] = handleObj.needsContext ?</span><br><span class="line">              jQuery( sel, <span class="keyword">this</span> ).index( cur ) &gt;= <span class="number">0</span> :</span><br><span class="line">              jQuery.find( sel, <span class="keyword">this</span>, <span class="literal">null</span>, [ cur ] ).length;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( selMatch[ sel ] ) &#123;</span><br><span class="line">            matches.push( handleObj );</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ( matches.length ) &#123;</span><br><span class="line">          handlerQueue.push(&#123; <span class="attr">elem</span>: cur, <span class="attr">matches</span>: matches &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 取得其他直接榜单的事件描述对象</span></span><br><span class="line">  <span class="comment">// Add the remaining (directly-bound) handlers</span></span><br><span class="line">  <span class="keyword">if</span> ( handlers.length &gt; delegateCount ) &#123;</span><br><span class="line">    handlerQueue.push(&#123; <span class="attr">elem</span>: <span class="keyword">this</span>, <span class="attr">matches</span>: handlers.slice( delegateCount ) &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 循环从下到上执行</span></span><br><span class="line">  <span class="comment">// Run delegates first; they may want to stop propagation beneath us</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; handlerQueue.length &amp;&amp; !event.isPropagationStopped(); i++ ) &#123;</span><br><span class="line">    matched = handlerQueue[ i ];</span><br><span class="line">    event.currentTarget = matched.elem;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行此元素的所有与event.type同类型的回调，除非调用了stopImmediatePropagation方法，</span></span><br><span class="line">    <span class="comment">// 其会导致isImmediatePropagationStopped返回true，从而中断循环</span></span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; matched.matches.length &amp;&amp; !event.isImmediatePropagationStopped(); j++ ) &#123;</span><br><span class="line">      handleObj = matched.matches[ j ];</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 最后的过滤条件为事件命名空间</span></span><br><span class="line">      <span class="comment">// Triggered event must either 1) be non-exclusive and have no namespace, or</span></span><br><span class="line">      <span class="comment">// 2) have namespace(s) a subset or equal to those in the bound event (both can have no namespace).</span></span><br><span class="line">      <span class="keyword">if</span> ( run_all || (!event.namespace &amp;&amp; !handleObj.namespace) || event.namespace_re &amp;&amp; event.namespace_re.test( handleObj.namespace ) ) &#123;</span><br><span class="line"></span><br><span class="line">        event.data = handleObj.data;</span><br><span class="line">        event.handleObj = handleObj;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 执行用户回调，</span></span><br><span class="line">        ret = ( (jQuery.event.special[ handleObj.origType ] || &#123;&#125;).handle || handleObj.handler )</span><br><span class="line">            .apply( matched.elem, args );</span><br><span class="line">        <span class="comment">// 根据结果判断是否阻止事件传播与默认行为</span></span><br><span class="line">        <span class="keyword">if</span> ( ret !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line">          event.result = ret;</span><br><span class="line">          <span class="keyword">if</span> ( ret === <span class="literal">false</span> ) &#123;</span><br><span class="line">            event.preventDefault();</span><br><span class="line">            event.stopPropagation();</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 执行postDispatch回调</span></span><br><span class="line">  <span class="comment">// Call the postDispatch hook for the mapped type</span></span><br><span class="line">  <span class="keyword">if</span> ( special.postDispatch ) &#123;</span><br><span class="line">    special.postDispatch.call( <span class="keyword">this</span>, event );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> event.result;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>这个方法的难点在于如何模拟事件传播的机制，而jquery只模拟冒泡的阶段。</p>
<p>一般来说触发事件的顺序与绑定时无关，而与绑定事件的元素在DOM树中的顺序有关，事件代理中的绑定元素通常位于DOM树顶端，如document、html、body，因此执行较晚。在jquery.event.add方法中，有一个delegateCount变量，用于在绑定时把对应的事件描述对象放在前面，因此dispatch时就方便很多。</p>
<h4 id="jQuery-event-trigger源码解读"><a href="#jQuery-event-trigger源码解读" class="headerlink" title="jQuery.event.trigger源码解读"></a>jQuery.event.trigger源码解读</h4><p>jQuery追求兼容性，所以trigger方法（即fireEvent）非常的好用，兼容性非常强。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line">trigger: <span class="function"><span class="keyword">function</span>(<span class="params"> event, data, elem, onlyHandlers </span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 必须指定派发事件的对象，不能是文本节点或元素节点</span></span><br><span class="line">  <span class="comment">// Don't do events on text and comment nodes</span></span><br><span class="line">  <span class="keyword">if</span> ( elem &amp;&amp; (elem.nodeType === <span class="number">3</span> || elem.nodeType === <span class="number">8</span>) ) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Event object or event type</span></span><br><span class="line">  <span class="keyword">var</span> cache, exclusive, i, cur, old, ontype, special, handle, eventPath, bubbleType,</span><br><span class="line">    type = event.type || event,</span><br><span class="line">    namespaces = [];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// focus/blur morphs to focusin/out; ensure we're not firing them right now</span></span><br><span class="line">  <span class="keyword">if</span> ( rfocusMorph.test( type + jQuery.event.triggered ) ) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( type.indexOf( <span class="string">"!"</span> ) &gt;= <span class="number">0</span> ) &#123;</span><br><span class="line">    <span class="comment">// Exclusive events trigger only for the exact event (no namespaces)</span></span><br><span class="line">    type = type.slice(<span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line">    exclusive = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 若事件类型带点号就分解出命名空间</span></span><br><span class="line">  <span class="keyword">if</span> ( type.indexOf( <span class="string">"."</span> ) &gt;= <span class="number">0</span> ) &#123;</span><br><span class="line">    <span class="comment">// Namespaced trigger; create a regexp to match event type in handle()</span></span><br><span class="line">    namespaces = type.split(<span class="string">"."</span>);</span><br><span class="line">    type = namespaces.shift();</span><br><span class="line">    namespaces.sort();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// customEvent与global用于优化，若没有绑定过这种事件，就不需要继续执行了</span></span><br><span class="line">  <span class="keyword">if</span> ( (!elem || jQuery.event.customEvent[ type ]) &amp;&amp; !jQuery.event.global[ type ] ) &#123;</span><br><span class="line">    <span class="comment">// No jQuery handlers for this event type, and it can't have inline handlers</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 将用户传入的第一个参数都转换为jQuery.Event实例</span></span><br><span class="line">  <span class="comment">// Caller can pass in an Event, Object, or just an event type string</span></span><br><span class="line">  event = <span class="keyword">typeof</span> event === <span class="string">"object"</span> ?</span><br><span class="line">    <span class="comment">// jQuery.Event object</span></span><br><span class="line">    event[ jQuery.expando ] ? event : <span class="comment">// JQuery.Event实例</span></span><br><span class="line">    <span class="comment">// Object literal</span></span><br><span class="line">    <span class="keyword">new</span> jQuery.Event( type, event ) : <span class="comment">// 原生事件对象</span></span><br><span class="line">    <span class="comment">// Just the event type (string)</span></span><br><span class="line">    <span class="keyword">new</span> jQuery.Event( type ); <span class="comment">// 事件类型</span></span><br><span class="line"></span><br><span class="line">  event.type = type;</span><br><span class="line">  event.isTrigger = <span class="literal">true</span>;</span><br><span class="line">  event.exclusive = exclusive;</span><br><span class="line">  event.namespace = namespaces.join( <span class="string">"."</span> );</span><br><span class="line">  event.namespace_re = event.namespace? <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"(^|\\.)"</span> + namespaces.join(<span class="string">"\\.(?:.*\\.|)"</span>) + <span class="string">"(\\.|$)"</span>) : <span class="literal">null</span>;</span><br><span class="line">  ontype = type.indexOf( <span class="string">":"</span> ) &lt; <span class="number">0</span> ? <span class="string">"on"</span> + type : <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 若没有指明触发者，只能将整个缓存系统寻找一遍</span></span><br><span class="line">  <span class="comment">// Handle a global trigger</span></span><br><span class="line">  <span class="keyword">if</span> ( !elem ) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> Stop taunting the data cache; remove global events and always attach to document</span></span><br><span class="line">    cache = jQuery.cache;</span><br><span class="line">    <span class="keyword">for</span> ( i <span class="keyword">in</span> cache ) &#123;</span><br><span class="line">      <span class="keyword">if</span> ( cache[ i ].events &amp;&amp; cache[ i ].events[ type ] ) &#123;</span><br><span class="line">        jQuery.event.trigger( event, data, cache[ i ].handle.elem, <span class="literal">true</span> );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 清理result，方便重复使用</span></span><br><span class="line">  <span class="comment">// Clean up the event in case it is being reused</span></span><br><span class="line">  event.result = <span class="literal">undefined</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !event.target ) &#123;</span><br><span class="line">    event.target = elem; <span class="comment">// 保持事件源不变</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// data用于放置派发事件时的额外参数，方便apply整合为数组，并将event放在第一位</span></span><br><span class="line">  <span class="comment">// Clone any incoming data and prepend the event, creating the handler arg list</span></span><br><span class="line">  data = data != <span class="literal">null</span> ? jQuery.makeArray( data ) : [];</span><br><span class="line">  data.unshift( event );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 若此事件类型指定了它的trigger方法，就直接使用</span></span><br><span class="line">  <span class="comment">// Allow special events to draw outside the lines</span></span><br><span class="line">  special = jQuery.event.special[ type ] || &#123;&#125;;</span><br><span class="line">  <span class="keyword">if</span> ( special.trigger &amp;&amp; special.trigger.apply( elem, data ) === <span class="literal">false</span> ) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 预先确定冒泡的路径，一直冒泡到window</span></span><br><span class="line">  <span class="comment">// Determine event propagation path in advance, per W3C events spec (#9951)</span></span><br><span class="line">  <span class="comment">// Bubble up to document, then to window; watch for a global ownerDocument var (#9724)</span></span><br><span class="line">  eventPath = [[ elem, special.bindType || type ]];</span><br><span class="line">  <span class="keyword">if</span> ( !onlyHandlers &amp;&amp; !special.noBubble &amp;&amp; !jQuery.isWindow( elem ) ) &#123;</span><br><span class="line"></span><br><span class="line">    bubbleType = special.delegateType || type;</span><br><span class="line">    cur = rfocusMorph.test( bubbleType + type ) ? elem : elem.parentNode;</span><br><span class="line">    <span class="keyword">for</span> ( old = elem; cur; cur = cur.parentNode ) &#123;</span><br><span class="line">      eventPath.push([ cur, bubbleType ]);</span><br><span class="line">      old = cur;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Only add window if we got to document (e.g., not plain obj or detached DOM)</span></span><br><span class="line">    <span class="keyword">if</span> ( old === (elem.ownerDocument || <span class="built_in">document</span>) ) &#123;</span><br><span class="line">      eventPath.push([ old.defaultView || old.parentWindow || <span class="built_in">window</span>, bubbleType ]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 沿着规划好的路径把经过的元素节点的指定事件类型的回调逐一触发</span></span><br><span class="line">  <span class="comment">// Fire handlers on the event path</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; eventPath.length &amp;&amp; !event.isPropagationStopped(); i++ ) &#123;</span><br><span class="line"></span><br><span class="line">    cur = eventPath[i][<span class="number">0</span>];</span><br><span class="line">    event.type = eventPath[i][<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// handle其实是调用dispatch函数，因此trigger是把整个冒泡过程都人工实现</span></span><br><span class="line">    handle = ( jQuery._data( cur, <span class="string">"events"</span> ) || &#123;&#125; )[ event.type ] &amp;&amp; jQuery._data( cur, <span class="string">"handle"</span> );</span><br><span class="line">    <span class="keyword">if</span> ( handle ) &#123;</span><br><span class="line">      handle.apply( cur, data );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理onXXX的绑定回调，无论是写在HTML标签内还是以无浸入方式</span></span><br><span class="line">    <span class="comment">// Note that this is a bare JS function and not a jQuery handler</span></span><br><span class="line">    handle = ontype &amp;&amp; cur[ ontype ];</span><br><span class="line">    <span class="keyword">if</span> ( handle &amp;&amp; jQuery.acceptData( cur ) &amp;&amp; handle.apply &amp;&amp; handle.apply( cur, data ) === <span class="literal">false</span> ) &#123;</span><br><span class="line">      event.preventDefault(); <span class="comment">// 若返回true则中断循环</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  event.type = type;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 若用户没有调用preventDefault或return false，则模拟默认行为</span></span><br><span class="line">  <span class="comment">// 具体指：执行submit、blur、focus、select、reset、scroll等方法</span></span><br><span class="line">  <span class="comment">// 大其实没有模拟所有默认行为</span></span><br><span class="line">  <span class="comment">// 比如点击链接时的跳转，点击单选/复选框时元素的checked会被改变</span></span><br><span class="line">  <span class="comment">// If nobody prevented the default action, do it now</span></span><br><span class="line">  <span class="keyword">if</span> ( !onlyHandlers &amp;&amp; !event.isDefaultPrevented() ) &#123;</span><br><span class="line">    <span class="comment">// 若用户指定了默认行为，则只执行默认行为，并且跳过链接的点击事件</span></span><br><span class="line">    <span class="keyword">if</span> ( (!special._default || special._default.apply( elem.ownerDocument, data ) === <span class="literal">false</span>) &amp;&amp;</span><br><span class="line">      !(type === <span class="string">"click"</span> &amp;&amp; jQuery.nodeName( elem, <span class="string">"a"</span> )) &amp;&amp; jQuery.acceptData( elem ) ) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 若元素同时存在el['on'+type]回调与el[type]方法，则表示有默认行为</span></span><br><span class="line">      <span class="comment">// 对于el[type]属性的检测，jQuery不使用isFunction方法，因为typeof在IE6~8下返回object</span></span><br><span class="line">      <span class="comment">// jquery也不触发隐藏元素的focus或blur默认新闻，IE6~8下会报错</span></span><br><span class="line">      <span class="comment">// 同时不触发window的默认行为，防止触发window.scroll方法</span></span><br><span class="line">      <span class="comment">// 该方法在IE和标准浏览器下存在差异，IE下执行默认scroll()为scroll(0,0)</span></span><br><span class="line">      <span class="comment">// Call a native DOM method on the target with the same name name as the event.</span></span><br><span class="line">      <span class="comment">// Can't use an .isFunction() check here because IE6/7 fails that test.</span></span><br><span class="line">      <span class="comment">// Don't do default actions on window, that's where global variables be (#6170)</span></span><br><span class="line">      <span class="comment">// IE&lt;9 dies on focus/blur to hidden element (#1486)</span></span><br><span class="line">      <span class="keyword">if</span> ( ontype &amp;&amp; elem[ type ] &amp;&amp; ((type !== <span class="string">"focus"</span> &amp;&amp; type !== <span class="string">"blur"</span>) || event.target.offsetWidth !== <span class="number">0</span>) &amp;&amp; !jQuery.isWindow( elem ) ) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// onXXX回调已经在$.event.dispatch方法执行过后不再触发</span></span><br><span class="line">        <span class="comment">// Don't re-trigger an onFOO event when we call its FOO() method</span></span><br><span class="line">        old = elem[ ontype ];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( old ) &#123;</span><br><span class="line">          elem[ ontype ] = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 标识正在触发此事件类型，防止后面的elem[type]()重复执行dispatch</span></span><br><span class="line">        <span class="comment">// Prevent re-triggering of the same event, since we already bubbled it above</span></span><br><span class="line">        jQuery.event.triggered = type;</span><br><span class="line">        elem[ type ](); <span class="comment">// 执行默认行为</span></span><br><span class="line">        jQuery.event.triggered = <span class="literal">undefined</span>; <span class="comment">// 还原</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( old ) &#123; <span class="comment">// 还原</span></span><br><span class="line">          elem[ ontype ] = old;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 与dispatch一样，返回event.result</span></span><br><span class="line">  <span class="keyword">return</span> event.result;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>trigger算是dispatch的加强版，dispatch只触发当前元素与其底下元素（事件代理）的回调，trigger则模拟整个冒泡过程，除了自身还触发其祖先节点和window的同类型回调。从源码看，trigger比dispatch多做的是触发事件的默认行为，涉及很多判断。这一点上zepto就做的比较简洁，即在某一个元素触发一个回调（dispatch），生成一个事件对象，然后依次让其冒泡，触发其他回调（dispatch）。</p>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/01/07/js-framework12/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Newer
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/01/06/js-framework10/" id="post_nav-older" class="next-content">
            Older
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>
    <!-- modified By KING 2017.11.16 -->
    <!-- Sidebar Avatar
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="KING's avatar">
    </div> -->

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        xmoyking@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="https://github.com/xmoyKing/xmoyKing.github.io" target="_blank" title="Star Me on GitHub">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">star</i>
                        
                        Star Me on GitHub
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                Home
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    Archives
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/03/">March 2018<span class="sidebar_archives-count">16</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/02/">February 2018<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/01/">January 2018<span class="sidebar_archives-count">10</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">December 2017<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">November 2017<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">October 2017<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">September 2017<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">August 2017<span class="sidebar_archives-count">13</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">July 2017<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/06/">June 2017<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/05/">May 2017<span class="sidebar_archives-count">15</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">April 2017<span class="sidebar_archives-count">15</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">March 2017<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/02/">February 2017<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/01/">January 2017<span class="sidebar_archives-count">18</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/12/">December 2016<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/11/">November 2016<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">October 2016<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">September 2016<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/08/">August 2016<span class="sidebar_archives-count">20</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">July 2016<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/06/">June 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/05/">May 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/04/">April 2016<span class="sidebar_archives-count">5</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                Categories
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Angular/">Angular<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/categories/AngularJS/">AngularJS<span class="sidebar_archives-count">50</span></a></li><li><a class="sidebar_archives-link" href="/categories/CSS/">CSS<span class="sidebar_archives-count">21</span></a></li><li><a class="sidebar_archives-link" href="/categories/Java/">Java<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/JavaScript/">JavaScript<span class="sidebar_archives-count">92</span></a></li><li><a class="sidebar_archives-link" href="/categories/Linux/">Linux<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Nodejs/">Nodejs<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/categories/TypeScript/">TypeScript<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/WebApp/">WebApp<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/categories/jQuery/">jQuery<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/categories/linux/">linux<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/mixed/">mixed<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/categories/mongodb/">mongodb<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/python/">python<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/three-js/">three.js<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/区块链/">区块链<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/响应式-Web-设计/">响应式 Web 设计<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/安全/">安全<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/网络/">网络<span class="sidebar_archives-count">10</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="Tags">
                
                    <i class="material-icons sidebar-material-icons">bookmark</i>
                
                Tags
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
    
        <li>
            <a href="/2017/01/01/0_links/" title="Links">
                
                    <i class="material-icons sidebar-material-icons">polymer</i>
                
                Links
            </a>
        </li>
        
    
        <li>
            <a href="/2018/02/16/0_booklist/" title="Booklist">
                
                    <i class="material-icons sidebar-material-icons">code</i>
                
                Booklist
            </a>
        </li>
        
    
        <li>
            <a href="/2017/03/01/0_mixed/" title="Notes">
                
                    <i class="material-icons sidebar-material-icons">assignment</i>
                
                Notes
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                Number of articles
                <span class="sidebar-badge">250</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    
        <a href="https://plus.google.com/114920706759690760782" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    
        <a href="http://weibo.com/p/1005052419772155" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-weibo">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="http://github.com/xmoyking" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>KING · NOTE
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/js/lazyload.min.js", true)</script>



    <script>lsloader.load("js_js","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/js/js.min.js", true)</script>



    <script>lsloader.load("np_js","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/js/nprogress.js", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
