<!DOCTYPE html>
<html style="display: none;" lang="en">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.0 -->
    <script>
        window.materialVersion = "1.5.0"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">

    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source"/>














    <!-- Title -->
    
    <title>
        
            JavaScript框架设计笔记-9-属性模块 | 
        
        KING · NOTE
    </title>

    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="format-detection" content="telephone=no"/>
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="KING">
    <meta name="description" itemprop="description" content="Loneliness is the carnival of one single soul.">
    <meta name="keywords" content=",JavaScript,JavaScript框架设计">

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(key){try{localStorage.removeItem(key)}catch(e){}};lsloader.setLS=function(key,val){try{localStorage.setItem(key,val)}catch(e){}};lsloader.getLS=function(key){var val="";try{val=localStorage.getItem(key)}catch(e){val=""}return val};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var keys=[];for(var i=0;i<localStorage.length;i++){keys.push(localStorage.key(i))}keys.forEach(function(key){var data=lsloader.getLS(key);if(window.oldVersion){var remove=window.oldVersion.reduce(function(p,c){return p||data.indexOf("/*"+c+"*/")!==-1},false);if(remove){lsloader.removeLS(key)}}})}catch(e){}};lsloader.clean();lsloader.load=function(jsname,jspath,cssonload,isJs){if(typeof cssonload==="boolean"){isJs=cssonload;cssonload=undefined}isJs=isJs||false;cssonload=cssonload||function(){};var code;code=this.getLS(jsname);if(code&&code.indexOf(versionString)===-1){this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}if(code){var versionNumber=code.split(versionString)[0];if(versionNumber!=jspath){console.log("reload:"+jspath);this.removeLS(jsname);this.requestResource(jsname,jspath,cssonload,isJs);return}code=code.split(versionString)[1];if(isJs){this.jsRunSequence.push({name:jsname,code:code});this.runjs(jspath,jsname,code)}else{document.getElementById(jsname).appendChild(document.createTextNode(code));cssonload()}}else{this.requestResource(jsname,jspath,cssonload,isJs)}};lsloader.requestResource=function(name,path,cssonload,isJs){var that=this;if(isJs){this.iojs(path,name,function(path,name,code){that.setLS(name,path+versionString+code);that.runjs(path,name,code)})}else{this.iocss(path,name,function(code){document.getElementById(name).appendChild(document.createTextNode(code));that.setLS(name,path+versionString+code)},cssonload)}};lsloader.iojs=function(path,jsname,callback){var that=this;that.jsRunSequence.push({name:jsname,code:""});try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(path,jsname,xhr.response);return}}that.jsfallback(path,jsname)}};xhr.send(null)}catch(e){that.jsfallback(path,jsname)}};lsloader.iocss=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.iofonts=function(path,jsname,callback,cssonload){var that=this;try{var xhr=new XMLHttpRequest;xhr.open("get",path,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){callback(xhr.response);cssonload();return}}that.cssfallback(path,jsname,cssonload)}};xhr.send(null)}catch(e){that.cssfallback(path,jsname,cssonload)}};lsloader.runjs=function(path,name,code){if(!!name&&!!code){for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code=code}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var script=document.createElement("script");script.appendChild(document.createTextNode(this.jsRunSequence[0].code));script.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(script);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var that=this;var script=document.createElement("script");script.src=this.jsRunSequence[0].path;script.type="text/javascript";this.jsRunSequence[0].status="loading";script.onload=function(){that.jsRunSequence.shift();if(that.jsRunSequence.length>0){that.runjs()}};document.body.appendChild(script)}};lsloader.tagLoad=function(path,name){this.jsRunSequence.push({name:name,code:"",path:path,status:"failed"});this.runjs()};lsloader.jsfallback=function(path,name){if(!!this.jsnamemap[name]){return}else{this.jsnamemap[name]=name}for(var k in this.jsRunSequence){if(this.jsRunSequence[k].name==name){this.jsRunSequence[k].code="";this.jsRunSequence[k].status="failed";this.jsRunSequence[k].path=path}}this.runjs()};lsloader.cssfallback=function(path,name,cssonload){if(!!this.cssnamemap[name]){return}else{this.cssnamemap[name]=1}var link=document.createElement("link");link.type="text/css";link.href=path;link.rel="stylesheet";link.onload=link.onerror=cssonload;var root=document.getElementsByTagName("script")[0];root.parentNode.insertBefore(link,root)};lsloader.runInlineScript=function(scriptId,codeId){var code=document.getElementById(codeId).innerText;this.jsRunSequence.push({name:scriptId,code:code});this.runjs()};lsloader.loadCombo=function(jslist){var updateList="";var requestingModules={};for(var k in jslist){var LS=this.getLS(jslist[k].name);if(!!LS){var version=LS.split(versionString)[0];var code=LS.split(versionString)[1]}else{var version=""}if(version==jslist[k].path){this.jsRunSequence.push({name:jslist[k].name,code:code,path:jslist[k].path})}else{this.jsRunSequence.push({name:jslist[k].name,code:null,path:jslist[k].path,status:"comboloading"});requestingModules[jslist[k].name]=true;updateList+=(updateList==""?"":";")+jslist[k].path}}var that=this;if(!!updateList){var xhr=new XMLHttpRequest;xhr.open("get",combo+updateList,true);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){if(xhr.response!=""){that.runCombo(xhr.response,requestingModules);return}}else{for(var i in that.jsRunSequence){if(requestingModules[that.jsRunSequence[i].name]){that.jsRunSequence[i].status="failed"}}that.runjs()}}};xhr.send(null)}this.runjs()};lsloader.runCombo=function(comboCode,requestingModules){comboCode=comboCode.split("/*combojs*/");comboCode.shift();for(var k in this.jsRunSequence){if(!!requestingModules[this.jsRunSequence[k].name]&&!!comboCode[0]){this.jsRunSequence[k].status="comboJS";this.jsRunSequence[k].code=comboCode[0];this.setLS(this.jsRunSequence[k].name,this.jsRunSequence[k].path+versionString+comboCode[0]);comboCode.shift()}}this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!--iOS -->
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="KING · NOTE">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.en.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/css/material.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/css/style.min.css",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->
<!-- add By KING 2017.11.16 -->
<link rel="stylesheet" href="/css/highlightjs/vs.css">
<style>
  #scheme-Paradox .material-layout .highlight .meta{
    display: initial;
    padding: initial;
  }
</style>


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icon -->

    <style>
        @font-face {
            font-family: 'Material Icons';
            font-style: normal;
            font-weight: 400;
            src: local('Material Icons'),
            local('MaterialIcons-Regular'),
            url(https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/fonts/MaterialIcons-Regular.woff2) format('woff2'),
            url(https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/fonts/MaterialIcons-Regular.woff) format('woff'),
            url(https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/fonts/MaterialIcons-Regular.ttf) format('truetype');
        }
    </style>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/js/jquery.min.js", true)</script>
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://github.com/xmoyKING">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="JavaScript框架设计笔记-9-属性模块 | KING · NOTE">
    <meta property="og:image" content="https://github.com/xmoyKING/img/favicon.png" />
    <meta property="og:description" content="Loneliness is the carnival of one single soul.">
    <meta property="og:article:tag" content="JavaScript"> <meta property="og:article:tag" content="JavaScript框架设计"> 

    
        <meta property="article:published_time" content="Thu Jan 05 2017 14:53:31 GMT+0800" />
        <meta property="article:modified_time" content="Thu Jan 05 2017 14:53:31 GMT+0800" />
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:title" content="JavaScript框架设计笔记-9-属性模块 | KING · NOTE">
    <meta name="twitter:description" content="Loneliness is the carnival of one single soul.">
    <meta name="twitter:image" content="https://github.com/xmoyKING/img/favicon.png">
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://github.com/xmoyKING" />

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://github.com/xmoyKING/2017/01/05/js-framework9/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "https://github.com/xmoyKING/2017/01/05/js-framework9/index.html",
    "headline": "JavaScript框架设计笔记-9-属性模块",
    "datePublished": "Thu Jan 05 2017 14:53:31 GMT+0800",
    "dateModified": "Thu Jan 05 2017 14:53:31 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "KING",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.png"
        },
        "description": "Loneliness is the carnival of one single soul."
    },
    "publisher": {
        "@type": "Organization",
        "name": "KING · NOTE",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",JavaScript,JavaScript框架设计",
    "description": "Loneliness is the carnival of one single soul.",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#如何区分固有属性与自定义属性"><span class="post-toc-number">1.</span> <span class="post-toc-text">如何区分固有属性与自定义属性</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#如何判断浏览器是否区分固有属性与自定义属性"><span class="post-toc-number">2.</span> <span class="post-toc-text">如何判断浏览器是否区分固有属性与自定义属性</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#className的操作"><span class="post-toc-number">3.</span> <span class="post-toc-text">className的操作</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#jquery的属性系统"><span class="post-toc-number">4.</span> <span class="post-toc-text">jquery的属性系统</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#mass-Framework的属性系统"><span class="post-toc-number">5.</span> <span class="post-toc-text">mass Framework的属性系统</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#value的操作"><span class="post-toc-number">6.</span> <span class="post-toc-text">value的操作</span></a></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                JavaScript框架设计笔记-9-属性模块
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>KING</strong>
        <span>Jan 05, 2017</span>
        <!-- Updated Time , add By KING 2017.11.16 -->
        <span>Jan 05, 2017 UPDATED</span> 
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/JavaScript/">JavaScript</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/JavaScript框架设计/">JavaScript框架设计</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=JavaScript框架设计笔记-9-属性模块&url=https://github.com/xmoyKING/2017/01/05/js-framework9/index.html&pic=https://github.com/xmoyKING/img/favicon.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                Share to Weibo
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=JavaScript框架设计笔记-9-属性模块&url=https://github.com/xmoyKING/2017/01/05/js-framework9/index.html&via=KING" target="_blank">
            <li class="mdl-menu__item">
                Share to Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://github.com/xmoyKING/2017/01/05/js-framework9/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://github.com/xmoyKING/2017/01/05/js-framework9/index.html" target="_blank">
            <li class="mdl-menu__item">
                Share to Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>通常将对象的非函数成员叫属性，对于元素节点而言，其属性分为两类，固有属性和自定义属性（特性）。固有属性一般遵循驼峰命名，有默认值，并且无法删除。自定义属性是用户添加的键值对，由于元素节点也是一个普通的JS对象，并没有严格的访问限制，所以命名风格和值的类型都很随意，很有可能会引起循环引用或其他问题，所以浏览器为了规范这些自定义属性，提供了一组API，即setAttribute、getAttribute、removeAttribute，这3个通常就是DOM属性系统了，DOM属性系统对属性名进行小写话处理，属性值统一转为字符串。IE6、7会有兼容性问题（非常尴尬，前端的世界到处是兼容问题）</p>
<p>多年的发展，谁也不知道某个元素节点到底有多少个属性，for…in循环对不可遍历属性无用。而H5对属性进行了更多的分类，比如dataset对象包括所有以data-开头的自定义属性，classList包括所有的类名，且有对应的API操作，formData包括所有要提交到后端的数据…<br>而且值的类型也是五花八门，有整数、0/1、on/off、yes/no，布尔值等。</p>
<h4 id="如何区分固有属性与自定义属性"><a href="#如何区分固有属性与自定义属性" class="headerlink" title="如何区分固有属性与自定义属性"></a>如何区分固有属性与自定义属性</h4><p>探索的方法很多，但是很多都失败了，最后留下了一个方法, 通过API访问和下标访问的差异：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 有些属性是特殊元素才有的，需要用到第二个参数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isAttribute</span>(<span class="params">attr, host</span>)</span>&#123;</span><br><span class="line">  host = host || <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">  <span class="keyword">return</span> host.getAttribute(attr) ==== <span class="literal">null</span> &amp;&amp; host[attr] === <span class="keyword">void</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="如何判断浏览器是否区分固有属性与自定义属性"><a href="#如何判断浏览器是否区分固有属性与自定义属性" class="headerlink" title="如何判断浏览器是否区分固有属性与自定义属性"></a>如何判断浏览器是否区分固有属性与自定义属性</h4><p>除了IE6、7不区分固有属性与自定义属性，其他现代浏览器都区分，基本可以不用考虑这个话题了。</p>
<h4 id="className的操作"><a href="#className的操作" class="headerlink" title="className的操作"></a>className的操作</h4><p>通常操作一个属性只有3个选择，设置、读取、删除，但className比较特殊，它的值是用空格隔开的，分为多个类名，因此对类名的操作就有：读取、添加、删减。总结下来就是：classNames、hasClassName、addClassName、removeClassName、toggleClassName。基本和H5的classList(有add、remove、toggle、contains方法)类似。</p>
<p>简化一下，将这些方法作为工具函数，在不引入任何框架的时候可以非常有用：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> getClass = <span class="function"><span class="keyword">function</span>(<span class="params">ele</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> ele.className.replace(<span class="regexp">/\s+/</span>,<span class="string">' '</span>).split(<span class="string">''</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> hasClass = <span class="function"><span class="keyword">function</span>(<span class="params">ele, cls</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">-1</span> &lt; (<span class="string">' '</span>+ele.className+<span class="string">' '</span>).indexOf(<span class="string">' '</span>+cls+<span class="string">' '</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> addClass = <span class="function"><span class="keyword">function</span>(<span class="params">ele, cls</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(!<span class="keyword">this</span>.hasClass(ele, cls))</span><br><span class="line">    ele.className += <span class="string">' '</span>+cls;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> removeClass = <span class="function"><span class="keyword">function</span>(<span class="params">ele, cls</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(hasClass(ele, cls))&#123;</span><br><span class="line">    <span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'(\\s|^)'</span>+cls+<span class="string">'(\\s|$)'</span>);</span><br><span class="line">    ele.className = ele.className.replace(reg, <span class="string">' '</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> clearClass = <span class="function"><span class="keyword">function</span>(<span class="params">ele, cls</span>)</span>&#123;</span><br><span class="line">  ele.className = <span class="string">''</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>jquery实现如下：</p>
<p>其addClass方法关键在去重,其参数可以为函数，而且通过indexOf来回避已有的类名，添加新类名后需要trim操作,所以非常长：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">addClass: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> classNames, i, l, elem, setClass, c, cl;</span><br><span class="line">  <span class="keyword">if</span>(jQuery.isFunction(value))&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.each(<span class="function"><span class="keyword">function</span>(<span class="params">j</span>)</span>&#123;</span><br><span class="line">      jQuery(<span class="keyword">this</span>).addClass(value.call(<span class="keyword">this</span>, j, <span class="keyword">this</span>.className));</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(value &amp;&amp; <span class="keyword">typeof</span> value === <span class="string">'string'</span>)&#123;</span><br><span class="line">    classNames = value.split(<span class="regexp">/\s+/</span>);</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>, l = <span class="keyword">this</span>.length; i &lt; l; i++)&#123;</span><br><span class="line">      elem = <span class="keyword">this</span>[i];</span><br><span class="line">      <span class="keyword">if</span>(elem.nodeType == <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!elem.className &amp;&amp; classNames.length === <span class="number">1</span>)&#123;</span><br><span class="line">          elem.className = value;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          setClass = <span class="string">' '</span>+elem.className+<span class="string">' '</span>;</span><br><span class="line">          <span class="keyword">for</span>(c = <span class="number">0</span>, cl = className.lenght; c &lt; cl; c++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(setClass.indexOf(<span class="string">' '</span>+ classNames[c]+<span class="string">' '</span>) &lt; <span class="number">0</span>)&#123;</span><br><span class="line">              setClass += classNames[c]+<span class="string">' '</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          elem.className = jQuery.trim(setClass);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>hash去重法的特点就是快：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">addClass: <span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> item === <span class="string">'string'</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, el; el = <span class="keyword">this</span>[i++];)&#123;</span><br><span class="line">      <span class="keyword">if</span>(el.nodeType === <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!el.className)&#123;</span><br><span class="line">          el.className = item;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="keyword">var</span> obj = &#123;&#125;, set = <span class="string">''</span>;</span><br><span class="line">          (el.className+<span class="string">' '</span>+cls).replace(<span class="regexp">/\S+/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">w</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(!obj[<span class="string">'@'</span>+w])&#123; <span class="comment">// 对付旧版本IE的toString</span></span><br><span class="line">              set += w+<span class="string">' '</span>;</span><br><span class="line">              obj[<span class="string">'@'</span>+w] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">          el.className = set.slice(<span class="number">0</span>, set.length - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>将hash去重改为数组去重，则性能不错，长度也短：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">addClass: <span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> item === <span class="string">'string'</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, el; el = <span class="keyword">this</span>[i++];)&#123;</span><br><span class="line">      <span class="keyword">if</span>(el.nodeType === <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!el.className)&#123;</span><br><span class="line">          el.className = item;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="keyword">var</span> a = (el.className+<span class="string">' '</span>+cls).match(<span class="regexp">/\S+/g</span>);</span><br><span class="line">          a.sort();</span><br><span class="line">          <span class="keyword">for</span>(<span class="keyword">var</span> i = a.length - <span class="number">1</span>; i &gt; <span class="number">0</span>; --i)</span><br><span class="line">            <span class="keyword">if</span>(a[i] == a[i<span class="number">-1</span>])</span><br><span class="line">              a.splice(i, <span class="number">1</span>);</span><br><span class="line">          el.className = a.join(<span class="string">' '</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>removeClass能同时删除多个类名，不传参时清除所有类名：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">removeClass: <span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>((item&amp;&amp;<span class="keyword">typeof</span> item === <span class="string">'string'</span>) || item === <span class="keyword">void</span> <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="comment">// var rnospaces = /\S+/g;</span></span><br><span class="line">    <span class="keyword">var</span> classNames = (item || <span class="string">''</span>).match(rnospaces), cl = classNames.length;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, node; node = <span class="keyword">this</span>[i++];)&#123;</span><br><span class="line">      <span class="keyword">if</span>(node.nodeType === <span class="number">1</span> &amp;&amp; node.className)&#123;</span><br><span class="line">        <span class="keyword">if</span>(item)&#123;</span><br><span class="line">          <span class="keyword">var</span> set = <span class="string">' '</span>+node.className.match(rnospaces).join(<span class="string">' '</span>) + <span class="string">' '</span>;</span><br><span class="line">          <span class="keyword">for</span>(<span class="keyword">var</span> c = <span class="number">0</span>; c &lt; cl; c++)&#123;</span><br><span class="line">            set = set.replace(<span class="string">' '</span>+ classNames[c] +<span class="string">' '</span>, <span class="string">' '</span>);</span><br><span class="line">          &#125;</span><br><span class="line">          node.className = set.slice(<span class="number">1</span>, set.length - <span class="number">1</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          node.className = <span class="string">''</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>hasClass方法，当第二个参数为true，要求所有匹配的元素都拥有此类名才返回true,若H5的classList可用则直接用原生<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hasClass: <span class="function"><span class="keyword">function</span>(<span class="params">item, every</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> method = every === <span class="literal">true</span> ? <span class="string">'every'</span> : <span class="string">'some'</span>,</span><br><span class="line">    rclass = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'(\\s|^)'</span>+item+<span class="string">'(\\s|$)'</span>); <span class="comment">// 判断多个元素、正则比indexOf快</span></span><br><span class="line">    <span class="keyword">return</span> $.slice(<span class="keyword">this</span>)[method](<span class="function"><span class="keyword">function</span>(<span class="params">el</span>)</span>&#123;</span><br><span class="line">      <span class="comment">// 先转换wield数组</span></span><br><span class="line">      <span class="keyword">return</span> <span class="string">'classList'</span> <span class="keyword">in</span> el ? el.classList.contains(item): (el.className || <span class="string">''</span>).match(rclass);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>toggleClass，常用于下拉菜单的展开收起,可接收一个布尔值，true表示addClass，false表示removeClass,依靠数据缓存系统，还可以在删除之前把它们存储起来，那么下次加上类名时直接从缓存系统中获取：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">toggleClass: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> type = <span class="keyword">typeof</span> value, className, i;</span><br><span class="line">  className = type === <span class="string">'string'</span> &amp;&amp; value.match(<span class="regexp">/\S+/g</span>) || [];</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.each(<span class="function"><span class="keyword">function</span>(<span class="params">el</span>)</span>&#123;</span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(el.nodeType === <span class="number">1</span>)&#123;</span><br><span class="line">      <span class="keyword">var</span> self = $(el);</span><br><span class="line">      <span class="keyword">if</span>(type == <span class="string">'string'</span>)&#123;</span><br><span class="line">        <span class="keyword">while</span>((className = className[i++]))&#123;</span><br><span class="line">          self[self.hasClass(className) ? <span class="string">'removeClass'</span> : <span class="string">'addClass'</span>](className);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span>(type === <span class="string">'undefined'</span> || type === <span class="string">'boolean'</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(el.className)&#123;</span><br><span class="line">          $._data(el,<span class="string">'__className__'</span>, el.className);</span><br><span class="line">        &#125;</span><br><span class="line">        el.className = el.className || value === <span class="literal">false</span> ? <span class="string">''</span> : $._data(el, <span class="string">'__className__'</span>) || <span class="string">''</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="jquery的属性系统"><a href="#jquery的属性系统" class="headerlink" title="jquery的属性系统"></a>jquery的属性系统</h4><p>jquery的属性系统是经年累月，量变引发质变的结果。太过早期就不用关注了，直接看从<a href="https://github.com/jquery/jquery/blob/1.8.3/src/attributes.js">jquery1.8.3</a>看起：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">prop: <span class="function"><span class="keyword">function</span>(<span class="params"> elem, name, value </span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> ret, hooks, notxml,</span><br><span class="line">		nType = elem.nodeType;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// 跳过注释、文本、特性节点</span></span><br><span class="line">	<span class="comment">// don't get/set properties on text, comment and attribute nodes</span></span><br><span class="line">	<span class="keyword">if</span> ( !elem || nType === <span class="number">3</span> || nType === <span class="number">8</span> || nType === <span class="number">2</span> ) &#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	notxml = nType !== <span class="number">1</span> || !jQuery.isXMLDoc( elem );</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( notxml ) &#123;</span><br><span class="line">     <span class="comment">// 若是HTML文档的元素节点</span></span><br><span class="line">		<span class="comment">// Fix name and attach hooks</span></span><br><span class="line">		name = jQuery.propFix[ name ] || name;</span><br><span class="line">		hooks = jQuery.propHooks[ name ];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// 写方法</span></span><br><span class="line">	<span class="keyword">if</span> ( value !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line">		<span class="keyword">if</span> ( hooks &amp;&amp; <span class="string">"set"</span> <span class="keyword">in</span> hooks &amp;&amp; (ret = hooks.set( elem, value, name )) !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line">			<span class="keyword">return</span> ret; <span class="comment">// 处理特殊情况</span></span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123; <span class="comment">// 通用情况</span></span><br><span class="line">			<span class="keyword">return</span> ( elem[ name ] = value );</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123; <span class="comment">// 读方法</span></span><br><span class="line">		<span class="keyword">if</span> ( hooks &amp;&amp; <span class="string">"get"</span> <span class="keyword">in</span> hooks &amp;&amp; (ret = hooks.get( elem, name )) !== <span class="literal">null</span> ) &#123;</span><br><span class="line">			<span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> elem[ name ];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"> <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"> attr: <span class="function"><span class="keyword">function</span>(<span class="params"> elem, name, value, pass </span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> ret, hooks, notxml,</span><br><span class="line">		nType = elem.nodeType;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// don't get/set attributes on text, comment and attribute nodes</span></span><br><span class="line">	<span class="keyword">if</span> ( !elem || nType === <span class="number">3</span> || nType === <span class="number">8</span> || nType === <span class="number">2</span> ) &#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( pass &amp;&amp; jQuery.isFunction( jQuery.fn[ name ] ) ) &#123;</span><br><span class="line">		<span class="keyword">return</span> jQuery( elem )[ name ]( value );</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Fallback to prop when attributes are not supported</span></span><br><span class="line">	<span class="keyword">if</span> ( <span class="keyword">typeof</span> elem.getAttribute === <span class="string">"undefined"</span> ) &#123;</span><br><span class="line">		<span class="keyword">return</span> jQuery.prop( elem, name, value );</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	notxml = nType !== <span class="number">1</span> || !jQuery.isXMLDoc( elem );</span><br><span class="line"></span><br><span class="line">	<span class="comment">// All attributes are lowercase</span></span><br><span class="line">	<span class="comment">// Grab necessary hook if one is defined</span></span><br><span class="line">	<span class="keyword">if</span> ( notxml ) &#123;</span><br><span class="line">		name = name.toLowerCase();</span><br><span class="line">		hooks = jQuery.attrHooks[ name ] || ( rboolean.test( name ) ? boolHook : nodeHook );</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( value !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> ( value === <span class="literal">null</span> ) &#123;</span><br><span class="line">			jQuery.removeAttr( elem, name );</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> ( hooks &amp;&amp; <span class="string">"set"</span> <span class="keyword">in</span> hooks &amp;&amp; notxml &amp;&amp; (ret = hooks.set( elem, value, name )) !== <span class="literal">undefined</span> ) &#123;</span><br><span class="line">			<span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			elem.setAttribute( name, value + <span class="string">""</span> );</span><br><span class="line">			<span class="keyword">return</span> value;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> ( hooks &amp;&amp; <span class="string">"get"</span> <span class="keyword">in</span> hooks &amp;&amp; notxml &amp;&amp; (ret = hooks.get( elem, name )) !== <span class="literal">null</span> ) &#123;</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line"></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">		ret = elem.getAttribute( name );</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Non-existent attributes return null, we normalize to undefined</span></span><br><span class="line">		<span class="keyword">return</span> ret === <span class="literal">null</span> ?</span><br><span class="line">			<span class="literal">undefined</span> :</span><br><span class="line">			ret;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<p>除此之外，还有很多钩子函数，且每个钩子的结构都不太一样，比如propHooks、attrHooks里都是以属性命名的对象，里面或存在get/set方法。</p>
<p>jquery对属性系统的主要贡献是发现更多的兼容性问题和解决方法，具体如下：</p>
<ol>
<li>tabindex的取值问题，tabindex默认情况下只对表单元素和链接有效，对于这些元素没有显示设置会返回0，对于div这样的普通元素返回-1，但IE都返回0，jquery做了统一处理</li>
<li>Safari下，option元素的selected取值问题，必须向上访问一下select元素才得到结果</li>
<li>表单元素的value属性的操作，由于表单元素种类繁多，存在严重兼容性问题，jquery做了很多处理</li>
</ol>
<p>但其缺点也有，如下：</p>
<ol>
<li>名字映射是穷举机制，attrFix和propFix待完善</li>
<li>对布尔属性的判断存在硬编码，准确率低</li>
<li>添加了一个与removeAttr对称的removeProp方法，但里面实现用到了delete操作符，在chrome中会有将固有属性从原型删除的风险</li>
<li>nodeHooks是使用getAttributeNode实现的，虽然能应对所有自定义属性，但判断某些固有属性是否为显示属性时，需要用fixSpecified补漏洞，但其是穷举机制</li>
<li>由于旧版本IE7不支持修改表单元素的type属性，导致在所有浏览器修改type属性，这个是不太好的处理方式</li>
</ol>
<h4 id="mass-Framework的属性系统"><a href="#mass-Framework的属性系统" class="headerlink" title="mass Framework的属性系统"></a>mass Framework的属性系统</h4><p>jquery之所以叫钩子，是由于它只会对特定属性进行回调（同步回调），最后根据结果是否直接返回还是默认处理，在prop方法，默认处理就是对目标进行数组法取赋值，在attr方法就是直接调用setAttribute或getAttribute。</p>
<p><a href="https://github.com/RubyLouvre/mass-Framework/blob/1.4/attr.js">mass Framework 1.4</a>使用适配器，在抵达适配器之前，就已经做好判断，是写还是读、是特殊处理还是默认处理，布尔属性也作为特殊处理的适配函数，在prop方法中，默认处理是@default:get/set方法，在attr方法中，默认处理是@w3c:get/set，@ie:get/set方法。只要直接返回适配方法的结果即可，流程非常简单清晰。</p>
<p>attr只处理元素节点，若是XML元素或其他对象类型，转交prop处理，若isXML为false，就试用propMap取得其js属性名，然后在attrHooks或propHooks取得钩子函数处理，在attr中，如值为false或null，需要做移除操作。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">prop: <span class="function"><span class="keyword">function</span>(<span class="params">node, name, value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>($[<span class="string">"@bind"</span>] <span class="keyword">in</span> node) &#123;</span><br><span class="line">        <span class="keyword">if</span>(node.nodeType === <span class="number">1</span> &amp;&amp; !$.isXML(node)) &#123;</span><br><span class="line">            name = $.propMap[name.toLowerCase()] || name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> access = value === <span class="keyword">void</span> <span class="number">0</span> ? <span class="string">"get"</span> : <span class="string">"set"</span>;</span><br><span class="line">        <span class="keyword">return</span>($.propHooks[name + <span class="string">":"</span> + access] || $.propHooks[<span class="string">"@default:"</span> + access])(node, name, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">attr: <span class="function"><span class="keyword">function</span>(<span class="params">node, name, value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>($[<span class="string">"@bind"</span>] <span class="keyword">in</span> node) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">typeof</span> node.getAttribute === <span class="string">"undefined"</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> $.prop(node, name, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//这里只剩下元素节点</span></span><br><span class="line">        <span class="keyword">var</span> noxml = !$.isXML(node),</span><br><span class="line">            type = <span class="string">"@w3c"</span>;</span><br><span class="line">        <span class="keyword">if</span>(noxml) &#123;</span><br><span class="line">            name = name.toLowerCase();</span><br><span class="line">            <span class="keyword">var</span> prop = $.propMap[name] || name;</span><br><span class="line">            <span class="keyword">if</span>(!support.attrInnateName) &#123;</span><br><span class="line">                type = <span class="string">"@ie"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> isBool = <span class="keyword">typeof</span> node[prop] === <span class="string">"boolean"</span> &amp;&amp; <span class="keyword">typeof</span> defaultProp(node, prop) === <span class="string">"boolean"</span>; <span class="comment">//判定是否为布尔属性</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//移除操作</span></span><br><span class="line">        <span class="keyword">if</span>(noxml) &#123;</span><br><span class="line">            <span class="keyword">if</span>(value === <span class="literal">null</span> || value === <span class="literal">false</span> &amp;&amp; isBool) &#123;</span><br><span class="line">                <span class="keyword">return</span> $.removeAttr(node, name);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(value === <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> node.removeAttribute(name);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//读写操作</span></span><br><span class="line">        <span class="keyword">var</span> access = value === <span class="keyword">void</span> <span class="number">0</span> ? <span class="string">"get"</span> : <span class="string">"set"</span>;</span><br><span class="line">        <span class="keyword">if</span>(isBool) &#123;</span><br><span class="line">            type = <span class="string">"@bool"</span>;</span><br><span class="line">            name = prop;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span>(noxml &amp;&amp; $.attrHooks[name + <span class="string">":"</span> + access] || $.attrHooks[type + <span class="string">":"</span> + access])(node, name, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></p>
<h4 id="value的操作"><a href="#value的操作" class="headerlink" title="value的操作"></a>value的操作</h4><p>一般而言，只有表单的value才有价值，而且涉及与后端交互，但表单的元素种类非常多，读写方式都不一样，所以需要在内部使用一个适配器来实现它。</p>
<p>对每个表单元素的情况需要分开处理：</p>
<ul>
<li>select元素，其value值为被选中的option孩子的value值，需要考虑select-one/multiple的情况，</li>
<li>option元素，它的value值可以是value属性的值，也可以是其文本值，当没有显示设置value时就是innerText，若显示设置了value，则在元素节点的attribute属性对象中（类数组对象，里面全是对象，每个对象拥有value、name、specified、ownerElement等很多属性），判断specified是否为true即可，在IE8或其他现代浏览器还可以用hasAttribute方法来判断。</li>
<li>button元素，它的value与option元素类似，但在标准浏览器下，button标签只有当其作为提交按钮时，才会提交自身的value值，此时统一返回value值。</li>
<li>checkbox、radio在设置value是需要考虑到checked属性的修改。</li>
</ul>
<p>最后<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> valHooks = &#123;</span><br><span class="line">    <span class="string">"option:get"</span>: <span class="function"><span class="keyword">function</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> val = node.attributes.value;</span><br><span class="line">        <span class="comment">//黑莓手机4.7下val会返回undefined,但我们依然可用node.value取值</span></span><br><span class="line">        <span class="keyword">return</span> !val || val.specified ? node.value : node.text;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"select:get"</span>: <span class="function"><span class="keyword">function</span>(<span class="params">node, value, getter</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> option, options = node.options,</span><br><span class="line">            index = node.selectedIndex,</span><br><span class="line">            one = node.type === <span class="string">"select-one"</span> || index &lt; <span class="number">0</span>,</span><br><span class="line">            values = one ? <span class="literal">null</span> : [],</span><br><span class="line">            max = one ? index + <span class="number">1</span> : options.length,</span><br><span class="line">            i = index &lt; <span class="number">0</span> ? max : one ? index : <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(; i &lt; max; i++) &#123;</span><br><span class="line">            option = options[i];</span><br><span class="line">            <span class="comment">//旧式IE在reset后不会改变selected，需要改用i === index判定</span></span><br><span class="line">            <span class="comment">//我们过滤所有disabled的option元素，但在safari5下，如果设置select为disable，那么其所有孩子都disable</span></span><br><span class="line">            <span class="comment">//因此当一个元素为disable，需要检测其是否显式设置了disable及其父节点的disable情况</span></span><br><span class="line">            <span class="keyword">if</span>((option.selected || i === index) &amp;&amp; !(support.optDisabled ? option.disabled : <span class="regexp">/ disabled=/</span>.test(option.outerHTML.replace(option.innerHTML, <span class="string">""</span>)))) &#123;</span><br><span class="line">                value = getter(option);</span><br><span class="line">                <span class="keyword">if</span>(one) &#123;</span><br><span class="line">                    <span class="keyword">return</span> value;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//收集所有selected值组成数组返回</span></span><br><span class="line">                values.push(value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> values;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"select:set"</span>: <span class="function"><span class="keyword">function</span>(<span class="params">node, name, values, getter</span>) </span>&#123;</span><br><span class="line">        values = [].concat(values); <span class="comment">//强制转换为数组</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>, el; el = node.options[i++];) &#123;</span><br><span class="line">            el.selected = !! ~values.indexOf(getter(el));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!values.length) &#123;</span><br><span class="line">            node.selectedIndex = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//checkbox的value默认为on，唯有chrome 返回空字符串</span></span><br><span class="line"><span class="keyword">if</span>(!support.checkOn) &#123;</span><br><span class="line">    valHooks[<span class="string">"checked:get"</span>] = <span class="function"><span class="keyword">function</span>(<span class="params">node</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> node.getAttribute(<span class="string">"value"</span>) === <span class="literal">null</span> ? <span class="string">"on"</span> : node.value;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//处理单选框，复选框在设值后checked的值</span></span><br><span class="line">valHooks[<span class="string">"checked:set"</span>] = <span class="function"><span class="keyword">function</span>(<span class="params">node, name, value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">Array</span>.isArray(value)) &#123;</span><br><span class="line">        <span class="keyword">return</span> node.checked = !! ~value.indexOf(node.value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>由getValType方法决定分配到那个适配器<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getValType</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> ret = el.tagName.toLowerCase();</span><br><span class="line">    <span class="keyword">return</span> ret === <span class="string">"input"</span> &amp;&amp; <span class="regexp">/checkbox|radio/</span>.test(el.type) ? <span class="string">"checked"</span> : ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>最后的val方法只是代理，唯一要做的就是将参数转换为字符串或字符串数组（针对select元素），然后让狗子函数执行：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用于取得表单元素的value值</span></span><br><span class="line">val: <span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> getter = valHooks[<span class="string">"option:get"</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">arguments</span>.length) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">Array</span>.isArray(item)) &#123;</span><br><span class="line">            item = item.map(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> item == <span class="literal">null</span> ? <span class="string">""</span> : item + <span class="string">""</span>;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isFinite</span>(item)) &#123;</span><br><span class="line">            item += <span class="string">""</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            item = item || <span class="string">""</span>; <span class="comment">//我们确保传参为字符串数组或字符串，null/undefined强制转换为"", number变为字符串</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $.access(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span> === $) &#123; <span class="comment">//getter</span></span><br><span class="line">            <span class="keyword">var</span> ret = (valHooks[getValType(el) + <span class="string">":get"</span>] || $.propHooks[<span class="string">"@default:get"</span>])(el, <span class="string">"value"</span>, getter);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">typeof</span> ret === <span class="string">"string"</span> ? ret.replace(rreturn, <span class="string">""</span>) : ret == <span class="literal">null</span> ? <span class="string">""</span> : ret;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">//setter</span></span><br><span class="line">            <span class="keyword">if</span>(el.nodeType === <span class="number">1</span>) &#123;</span><br><span class="line">                (valHooks[getValType(el) + <span class="string">":set"</span>] || $.propHooks[<span class="string">"@default:set"</span>])(el, <span class="string">"value"</span>, item, getter);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">0</span>, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/01/06/js-framework10/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Newer
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/01/02/js-framework8/" id="post_nav-older" class="next-content">
            Older
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>
    <!-- modified By KING 2017.11.16 -->
    <!-- Sidebar Avatar
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="KING's avatar">
    </div> -->

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        xmoyking@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="https://github.com/xmoyKing/xmoyKing.github.io" target="_blank" title="Star Me on GitHub">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">star</i>
                        
                        Star Me on GitHub
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                Home
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    Archives
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/03/">March 2018<span class="sidebar_archives-count">16</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/02/">February 2018<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/01/">January 2018<span class="sidebar_archives-count">10</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">December 2017<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">November 2017<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">October 2017<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">September 2017<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">August 2017<span class="sidebar_archives-count">13</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">July 2017<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/06/">June 2017<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/05/">May 2017<span class="sidebar_archives-count">15</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">April 2017<span class="sidebar_archives-count">15</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">March 2017<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/02/">February 2017<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/01/">January 2017<span class="sidebar_archives-count">18</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/12/">December 2016<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/11/">November 2016<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">October 2016<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/09/">September 2016<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/08/">August 2016<span class="sidebar_archives-count">20</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">July 2016<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/06/">June 2016<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/05/">May 2016<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                Categories
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Angular/">Angular<span class="sidebar_archives-count">14</span></a></li><li><a class="sidebar_archives-link" href="/categories/AngularJS/">AngularJS<span class="sidebar_archives-count">50</span></a></li><li><a class="sidebar_archives-link" href="/categories/CSS/">CSS<span class="sidebar_archives-count">17</span></a></li><li><a class="sidebar_archives-link" href="/categories/Java/">Java<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/JavaScript/">JavaScript<span class="sidebar_archives-count">92</span></a></li><li><a class="sidebar_archives-link" href="/categories/Linux/">Linux<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Nodejs/">Nodejs<span class="sidebar_archives-count">11</span></a></li><li><a class="sidebar_archives-link" href="/categories/Translation/">Translation<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/categories/TypeScript/">TypeScript<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/WebApp/">WebApp<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/categories/linux/">linux<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/mixed/">mixed<span class="sidebar_archives-count">9</span></a></li><li><a class="sidebar_archives-link" href="/categories/mongodb/">mongodb<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/python/">python<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/three-js/">three.js<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/区块链/">区块链<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/响应式-Web-设计/">响应式 Web 设计<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/categories/安全/">安全<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/categories/网络/">网络<span class="sidebar_archives-count">10</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="Tags">
                
                    <i class="material-icons sidebar-material-icons">bookmark</i>
                
                Tags
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
    
        <li>
            <a href="/2017/01/01/0_links/" title="Links">
                
                    <i class="material-icons sidebar-material-icons">polymer</i>
                
                Links
            </a>
        </li>
        
    
        <li>
            <a href="/2018/02/16/0_booklist/" title="Booklist">
                
                    <i class="material-icons sidebar-material-icons">code</i>
                
                Booklist
            </a>
        </li>
        
    
        <li>
            <a href="/2017/03/01/0_mixed/" title="Notes">
                
                    <i class="material-icons sidebar-material-icons">assignment</i>
                
                Notes
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                Number of articles
                <span class="sidebar-badge">245</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    
        <a href="https://plus.google.com/114920706759690760782" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    
        <a href="http://weibo.com/p/1005052419772155" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-weibo">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="http://github.com/xmoyking" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>KING · NOTE
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/js/lazyload.min.js", true)</script>



    <script>lsloader.load("js_js","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/js/js.min.js", true)</script>



    <script>lsloader.load("np_js","https://cdn.jsdelivr.net/npm/hexo-material@1.4.0/source/js/nprogress.js", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.0 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
