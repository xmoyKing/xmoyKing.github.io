---
title: angularjs巩固实践-38-如何设计友好的REST API
categories:
  - angularjs
tags:
  - angularjs
  - REST
date: 2017-08-17 22:59:21
updated:
---

#### URI

在REST中的典型uri一般是由名称和id组成，如：
- /users 表示所有用户列表
- /users/1 表示id为1的用户

若无特殊要求，id最好使用uuid，即使在非REST的架构中，uuid也有使用简单、无锁的优势。而在REST的架构中，除了上面的优点，还有利于分布式系统中独立处理，可以各自插入数据，而不用担心id冲突。

除了单层资源，在多层资源上，如：
- /users/1/files 表示用户1的所有文件
- /users/1/files/2 表示用户1的文件2

注意：资源层次不是越深约好的，参数过多会有使用不便的问题

理论上，任何多层资源都是由多个两层资源组合二层，所以本质上资源嵌套只要两层就够了，特别是使用uuid的情况下，可以更安全的拆分成两级嵌套，因此，除非在表意上确实有必要，否则使用两层资源即可。

定义uri的一个误区使表一些查询参数直接定义在uri中，如/users/age/20/60，显然比/users?minAge=20&&maxAge=60要难看多了。

#### 资源拆分
资源与领域类具有相当高的对应关系，资源的关联结构和领域类的关联结构也具有很大的相似性，当UML图出来的时候，REST API大概也出来了。

对于UML中表现为常规关联（Association，即普通箭头）或聚合（Aggregation，即空心方块）的关联，通常不需要设计多层资源，而组合（Composition,即实心方块）则意味着多层资源。

#### 资源命名
如类、变量、函数的命名一样，资源命名也是一门学问。

首先，资源名称应该是名称，也包括动名词的形式，但是不应该是动词。总之，资源要作为能够操作的对象，传统RPC形式的一些API也要映射为对资源的操作，比如登录过程其实就是一个创建安全令牌（Token）的过程，可以将API设计为
`POST /tokens`, 注销则是`DELETE /tokens/:id`

其次，需要注意名称的表意性，要尽量恰如其分的表示其业务含义，由于API的生命周期通常很长，所以多花精力是值得的。恰如其分就是只要在当前语境下用词贴切即可，不可过于啰嗦，如files不应该命名为userFiles

最后，要避免使用缩写词，避免使用有歧义的缩写甚至自创缩写，但像org这样的众所周知的缩写还是可以使用的。判断命名是否合适，最简单的就是找一个了解业务背景的非技术人员，是否能一眼看懂。