---
title: JavaScript高级程序设计-3-基本概念
categories: js
tags:
  - js
  - js-pro
date: 2016-08-04 13:48:51
updated:
---

记录js语言的基本概念的笔记、包括语法和流控制语句，分析js与其他基于C的语言在语法上的相同和不同之处，与内置操作符有关的类型转换问题。

### 语法
ES的语法大量借鉴了C及其他类C语言的语法，因此，熟悉语法的开发人员在接受ES更宽松的语法时会觉得很简单轻松。
- 区分大小写，ES的一切（包括变量名、函数名、操作符）都是区分大小写的
- 标识符，惯例按照小驼峰格式，如`myCar`,`firstList`,不能将保留字，关键字，true/false/null作为标识符
- 严格模式，ES5中引入的严格模式（strict mode）定义了不同于ES3的解析和执行模型。该模式纠正了一些ES3中不确定的行为，对某些不安全的操作会抛出错误。
  在脚本中添加`"use strict";`之后的代码将执行严格模式，这行代码看起来像字符串，而且没有赋值给任何变量，其实是一个编译指示（pragma），告诉js引擎切换到严格模式，这是为了不破坏ES3语法而特定选定的语法。
- 语句，ES中的语句以分号结尾，若省略分号，则由解析器确定语句的结尾。不省略分号能够避免很多错误（如不完整的输入），同时利于压缩，在某些情况下能增加代码的性能，因为解析器不必再花时间推测应该在哪里插入分号。
  代码块以花括号`{}`为界，虽然在条件控制语句（如if、for等）下只执行一行代码时能省略花括号，但最佳实践是始终写花括号，因为让代码更清晰，降低修改代码出错的几率

### 关键字和保留字 
[JS关键字和保留字](http://www.itxueyuan.org/view/6627.html)

### 变量
ES的变量是松散类型的，即可以用来保存任何类型的数据，将每个变量看作是一个用于保存值的占位符即可。定义变量时使用`var`操作符(var是一个关键字)，后面跟一个变量名（即标识符）。

使用var操作符定义的变量将成为定义该变量的作用域中的局部变量，也就是说，当在函数中使用var定义了一个变量，那么这个变量将在函数退出后被销毁，而未经初始化的变量会保存一个特殊的值`undefined`。

若省略var操作符则会定一个全局变量，但不推荐这样定义全局变量，在严格模式下，省略var操作符会报错，给一个未经声明的变量赋值在严格模式下会导致ReferenceError的错误，同时非常不利于维护，也容易导致一些混乱。

严格模式下，不能定义名为eval和arguments的变量（*虽然他们俩并不是保留字或关键字*）。

可以在一条语句内定义多个变量, 用逗号分开，初始化是可选的：
```js
var msg = 'hi',
    find = false,
    age = 11;
```

### 数据类型
ES定义了5中简单数据类型（基本数据类型）：`Undefined`,`Null`,`Boolean`,`Nu,mber`,`String`。以及一种复杂类型`Object`,其本质是无序的键值对集。ES不支持创建自定义类型，所有的值最终都是上述6种数据类型之一。但由于ES数据类型具有动态性，因此没有定义其他类型的必要。

#### typeof操作符
鉴于ES变量是松散类型，因此需要有一种手段来检测给定变量的数据类型，`typeof`就是干这个的，对一个值使用typeof操作符可能返回如下的字符串：
- `"undefined"` 若这个值未定义
- `"boolean"` 若这个值是布尔值
- `"string"` 若这个值是字符串
- `"number"` 若这个值是数字
- `"object"` 若这个值是**对象或null**
- `"function"` 若这个值是函数
`typeof`是一个操作符，不是函数，虽然可以用括号将其后跟的操作数包裹起来，操作数可以是变量，也可以是数值字面量。

从技术角度来说，ES中的函数是一个对象，而不是一种数据类型，这个对象有一些特殊的属性，因此通过typeof操作符区分函数和其他对象是有必要的。

注:因为特殊值null被认为是一个空对象引用，所以`typeof null`返回`"object"`。

#### Undefined类型
Undefined类型只有一个值，即`undefined`。在使用var声明变量但未对其加以初始化时这个变量的值就是undefined。

一般而言不需要显示将一个变量设置为undefined，字面量值undefined主要目的是用于比较。

但是包含undefined值的变量与未定义的变量还是不一样：
```js
var msg; // 这个变量声明后默认为undefined值

alert(msg); // "undefined"
alert(age); // 没有声明，产生错误
```
对于一个未声明的变量，只能进行一个操作，那就是使用typeof检测其数据类型（对未声明的变量调用delete在普通模式下虽然不报错但没有意义，同时严格模式还是会报错的）。同时需要注意的是，对未初始化的变量执行typeof会返回`"undefined"`值，与未声明的变量执行一样。即：
```js
var msg;
typeof msg === typeof age; // true
```
综上，显示初始化变量是一个好的选择，即当typeof操作符返回`"undefined"`的时候，就知道被检测变量没声明而不是没初始化。

#### Null类型
Null类型也是只有一个值的数据类型，即`null`。从逻辑上来说，null值表示一个空对象指针，所以typeof检测null返回object是合理的。

若定义的变量准备在将来用于保存对象，那么最好将变量初始化为null而不是其他值，这样只要对比null值就知道是否已经保存了一个对象的引用：
```js
if(car !== null){
  // ...
}
```
而undefined值派生自null，所以两者比较返回true（涉及到数据类型的隐式转换）,但用全等比较时则返回false，因为全等首先比较就是数据类型
```js
null == undefined; // true
null === undefined; // false
```
虽然null和undefined的关系有些混乱，但记着他们的用途不用就行了。即无论如何，没有必要将一个变量的值显示设置为undefined，但对null却没有这个规则。换句话说，只要意在保存对象的变量还没有真正保存对象时，就应该让其保存null，这样不仅能体现null作为空对象指针的惯例，也有助于进一步区分null和undefined。

#### Boolean类型
虽然Boolean类型只有两个字面量值：true和false，但其是用的最多的类型。注意：**true不一定等于1，false也不一定等于0**。同时他们是区分大小写的。

由于ES的隐式转换规则，所有类型的值都有与这两个Boolean值等价的值。也可以显示调用转换函数`Boolean()`将任意一个值转换为Boolean值：
```js
Boolean('hello'); // true
```
转换规则如下（需要特别注意数据的隐式转换）：

 | 数据类型       | 转换为true的值       |  转换为false的值    |
 | ------------- |:-------------------:|:------------------:|
 | String        | 任何非空字符串       | `""`（空字符串） |
 | Number        | 任何非零数字值（包括无穷）  |  0和`NaN` |
 | Object        | 任何对象            | null         |
 | Undefined     | 不适用此规则        | undefined   |

#### Number类型



